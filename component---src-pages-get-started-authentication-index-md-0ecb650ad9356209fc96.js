"use strict";(self.webpackChunkcommerce_webapi=self.webpackChunkcommerce_webapi||[]).push([[9466],{62353:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return d},default:function(){return p}});var n,o=a(87462),r=a(63366),s=(a(15007),a(64983)),i=a(91515),m=["components"],d={},c=(n="InlineAlert",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),(0,s.mdx)("div",e)}),u={_frontmatter:d},l=i.Z;function p(e){var t=e.components,a=(0,r.Z)(e,m);return(0,s.mdx)(l,(0,o.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,s.mdx)("h1",{id:"authentication"},"Authentication"),(0,s.mdx)("p",null,"Adobe Commerce and Magento Open Source allow developers to define web ",(0,s.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/api"},"API")," resources and their permissions in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"webapi.xml")," configuration file. See ",(0,s.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/commerce/php/development/components/web-api/services/"},"Services as Web APIs"),"."),(0,s.mdx)("p",null,"Before you can make ",(0,s.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/web-api"},"web API")," calls, you must authenticate your identity and have necessary permissions (authorization) to access the API resource. Authentication allows the application to identify the caller's user type. A user's (administrator, integration, customer, or guest) access rights determine an API call's resource accessibility."),(0,s.mdx)("h2",{id:"accessible-resources"},"Accessible resources"),(0,s.mdx)("p",null,"The list of resources that you can access depends on your user type. All customers have the same permissions, and as a result the same resources accessible. The preceding statement is true for guest users as well.\nEach administrator or integration user can have a unique set of permissions which is configured in the ",(0,s.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/magento-admin"},"Admin"),".\nPermissions required to access particular resource are configured in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"webapi.xml")," file. This table lists the resources that each user type can access:"),(0,s.mdx)("table",null,(0,s.mdx)("thead",{parentName:"table"},(0,s.mdx)("tr",{parentName:"thead"},(0,s.mdx)("th",{parentName:"tr",align:null},"User type"),(0,s.mdx)("th",{parentName:"tr",align:null},"Accessible resources (defined in webapi.xml)"))),(0,s.mdx)("tbody",{parentName:"table"},(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Administrator or Integration"),(0,s.mdx)("td",{parentName:"tr",align:null},"Resources for which administrators or integrators are authorized. For example, if administrators are authorized for the ",(0,s.mdx)("inlineCode",{parentName:"td"},"Magento_Customer::group")," resource, they can make a ",(0,s.mdx)("inlineCode",{parentName:"td"},"GET /V1/customerGroups/:id")," call.")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Customer"),(0,s.mdx)("td",{parentName:"tr",align:null},"Resources with ",(0,s.mdx)("inlineCode",{parentName:"td"},"anonymous")," or ",(0,s.mdx)("inlineCode",{parentName:"td"},"self")," permission")),(0,s.mdx)("tr",{parentName:"tbody"},(0,s.mdx)("td",{parentName:"tr",align:null},"Guest user"),(0,s.mdx)("td",{parentName:"tr",align:null},"Resources with ",(0,s.mdx)("inlineCode",{parentName:"td"},"anonymous")," permission")))),(0,s.mdx)("h2",{id:"relationship-between-aclxml-and-webapixml"},"Relationship between acl.xml and webapi.xml"),(0,s.mdx)("p",null,"The ",(0,s.mdx)("inlineCode",{parentName:"p"},"acl.xml")," file defines the access control list (ACL) for a given ",(0,s.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/module"},"module"),". It defines the available set of permissions to access resources."),(0,s.mdx)("p",null,"All ",(0,s.mdx)("inlineCode",{parentName:"p"},"acl.xml")," files across all modules are consolidated to build an ACL tree, which is used to select allowed ",(0,s.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/admin"},"Admin")," role resources or third-party integration access (",(0,s.mdx)("strong",{parentName:"p"},"System")," > ",(0,s.mdx)("strong",{parentName:"p"},"Extension")," > ",(0,s.mdx)("strong",{parentName:"p"},"Integration")," > ",(0,s.mdx)("strong",{parentName:"p"},"Add New Integration")," > ",(0,s.mdx)("strong",{parentName:"p"},"Available APIs"),")."),(0,s.mdx)("h3",{id:"sample-customer-aclxml"},"Sample customer acl.xml"),(0,s.mdx)("p",null,"For example, account management, customer configuration, and customer group resource permissions are defined in the Customer module's ",(0,s.mdx)("a",{parentName:"p",href:"https://github.com/magento/magento2/tree/2.4/app/code/Magento/Customer/etc/acl.xml"},(0,s.mdx)("inlineCode",{parentName:"a"},"acl.xml")),"."),(0,s.mdx)("p",null,"When a developer creates the Web API configuration file (",(0,s.mdx)("inlineCode",{parentName:"p"},"webapi.xml"),"), the permissions defined in acl.xml are referenced to create access rights for each API resource."),(0,s.mdx)("h3",{id:"sample-truncated-customer-webapixml"},"Sample (truncated) customer webapi.xml"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-xml"},'<routes xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n        xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Webapi:etc/webapi.xsd">\n    \x3c!-- Customer Group --\x3e\n    <route url="/V1/customerGroups/:id" method="GET">\n        <service class="Magento\\Customer\\Api\\GroupRepositoryInterface" method="getById"/>\n        <resources>\n            <resource ref="Magento_Customer::group"/>\n        </resources>\n    </route>\n............\n.......\n.....\n    \x3c!-- Customer Account --\x3e\n    <route url="/V1/customers/:customerId" method="GET">\n        <service class="Magento\\Customer\\Api\\CustomerRepositoryInterface" method="getById"/>\n        <resources>\n            <resource ref="Magento_Customer::customer"/>\n        </resources>\n    </route>\n    <route url="/V1/customers" method="POST">\n        <service class="Magento\\Customer\\Api\\AccountManagementInterface" method="createAccount"/>\n        <resources>\n            <resource ref="anonymous"/>\n        </resources>\n    </route>\n    <route url="/V1/customers/:customerId" method="PUT">\n        <service class="Magento\\Customer\\Api\\CustomerRepositoryInterface" method="save"/>\n        <resources>\n            <resource ref="Magento_Customer::manage"/>\n        </resources>\n    </route>\n    <route url="/V1/customers/me" method="PUT">\n        <service class="Magento\\Customer\\Api\\CustomerRepositoryInterface" method="save"/>\n        <resources>\n            <resource ref="self"/>\n        </resources>\n        <data>\n            <parameter name="customer.id" force="true">%customer_id%</parameter>\n        </data>\n    </route>\n..........\n.....\n...\n')),(0,s.mdx)("p",null,"For example, in the preceding ",(0,s.mdx)("inlineCode",{parentName:"p"},"webapi.xml")," for the customerGroups resource, only a user with ",(0,s.mdx)("inlineCode",{parentName:"p"},"Magento_Customer::group")," authorization can ",(0,s.mdx)("inlineCode",{parentName:"p"},"GET /V1/customerGroups/:id"),". On the other hand, you can create a customer using ",(0,s.mdx)("inlineCode",{parentName:"p"},"POST /V1/customers")," anonymously (or by a guest)."),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/authorization"},"Authorization")," is granted to either an administrator (or an integration) defined in the Admin with the customer group selected as one of the resources in the ACL tree."),(0,s.mdx)(c,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,s.mdx)("div",null,(0,s.mdx)("p",null,"A guest or anonymous is a special permission that doesn't need to be defined in ",(0,s.mdx)("inlineCode",{parentName:"p"},"acl.xml")," (and will not show up in the permissions tree in the Admin). It just indicates that the current resource in ",(0,s.mdx)("inlineCode",{parentName:"p"},"webapi.xml")," can be accessed without the need for authentication."),(0,s.mdx)("br",null),(0,s.mdx)("p",null,"Similarly, self is a special access used if you already have an authenticated session with the system. Self access enables a user to access resources they own. For example, ",(0,s.mdx)("inlineCode",{parentName:"p"},"GET /V1/customers/me")," fetches the logged-in customer's details. This is typically useful for JavaScript-based widgets.")),(0,s.mdx)("h2",{id:"web-api-clients-and-authentication-methods"},"Web API clients and authentication methods"),(0,s.mdx)("p",null,"You must use a client, such as a mobile application or an external batch job, to access services using web APIs."),(0,s.mdx)("p",null,"Each type of client has a preferred authentication method. To authenticate, use the authentication method for your preferred client:"),(0,s.mdx)("h3",{id:"mobile-application-authentication"},"Mobile application authentication"),(0,s.mdx)("p",null,"Registered users use ",(0,s.mdx)("a",{parentName:"p",href:"gs-authentication-token.md"},"token-based authentication")," to make web API calls using a mobile application. The token acts like an electronic key that provides access to the API(s)."),(0,s.mdx)("ol",null,(0,s.mdx)("li",{parentName:"ol"},(0,s.mdx)("p",{parentName:"li"},"As a registered account user, you request a token from the Magento token service at the endpoint that is defined for your user type.")),(0,s.mdx)("li",{parentName:"ol"},(0,s.mdx)("p",{parentName:"li"},"The token service returns a unique authentication token in exchange for a username and password for an admin or customer account.")),(0,s.mdx)("li",{parentName:"ol"},(0,s.mdx)("p",{parentName:"li"},"To prove your identity, specify this token in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"Authorization")," request header on web API calls."))),(0,s.mdx)("h3",{id:"third-party-application-authentication"},"Third-party application authentication"),(0,s.mdx)("p",null,"Third-party applications use ",(0,s.mdx)("a",{parentName:"p",href:"gs-authentication-oauth.md"},"OAuth-based authentication")," to access the web APIs."),(0,s.mdx)("ol",null,(0,s.mdx)("li",{parentName:"ol"},(0,s.mdx)("p",{parentName:"li"},"The third-party Integration registers with Adobe Commerce.")),(0,s.mdx)("li",{parentName:"ol"},(0,s.mdx)("p",{parentName:"li"},"Merchants authorize extensions and applications to access or update store data."))),(0,s.mdx)("h3",{id:"javascript-widget-authentication-storefront-or-admin"},"JavaScript widget authentication (storefront or Admin)"),(0,s.mdx)("p",null,"Registered users use ",(0,s.mdx)("a",{parentName:"p",href:"gs-authentication-session.md"},"session-based authentication")," to log in to the storefront or Admin."),(0,s.mdx)("p",null,"A session is identified by a cookie and time out after a period of inactivity. Additionally, you can have a session as a guest user without logging in."),(0,s.mdx)("ol",null,(0,s.mdx)("li",{parentName:"ol"},(0,s.mdx)("p",{parentName:"li"},"As a customer, you log in to the storefront with your customer credentials. As an administrator, you log in to the Admin with your administrator credentials.")),(0,s.mdx)("li",{parentName:"ol"},(0,s.mdx)("p",{parentName:"li"},"The web API framework identifies you and controls access to the requested resource."))),(0,s.mdx)("h2",{id:"authentication-types"},"Authentication types"),(0,s.mdx)("p",null,"The following sections describe tips about which type of authentication method you should use depending on your use case."),(0,s.mdx)("h3",{id:"token-based-bearer-authentication"},"Token based (Bearer Authentication)"),(0,s.mdx)("p",null,"This method is a good choice for authenticating customers and Admin users in third-party applications that need to make authorized API calls to the store."),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Customer Token"),"—Use this token in applications to authorize specific customer and query data related to that customer (for example, customer details, cart, and orders)."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Admin Token"),"—Use this token in applications to authorize an Admin user and access Admin-related APIs.")),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"./gs-authentication-token.md#request-a-token"},"Request a token")," and then include it in ",(0,s.mdx)("a",{parentName:"p",href:"./gs-authentication-token.md#use-the-token-in-a-web-api-request"},"future requests"),"."),(0,s.mdx)(c,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,"You should use this type of authentication mechanism over HTTPS."),(0,s.mdx)("h3",{id:"integration-oauth"},"Integration (Oauth)"),(0,s.mdx)("p",null,"This method is a good choice for integrating with a third-party system that supports OAuth 1.0a."),(0,s.mdx)("p",null,"After activating an integration (self activated), you can use the generated consumer key, consumer secret, access token, and access token secret to provide third-party systems access to Commerce Store resources. You do not need to make calls to the ",(0,s.mdx)("inlineCode",{parentName:"p"},"/oauth/token/request")," or ",(0,s.mdx)("inlineCode",{parentName:"p"},"/oauth/token/access")," endpoints to exchange tokens."),(0,s.mdx)("p",null,"If a third-party system provides endpoints, you can use them to ",(0,s.mdx)("a",{parentName:"p",href:"./gs-authentication-oauth.md#activate-an-integration"},"activate an integration")," and link your account. After completing the activation process, a third-party service can use the consumer key, consumer secret, access token, and access token secret provided by Commerce during activation to make API calls."),(0,s.mdx)("h4",{id:"related-topics"},"Related topics"),(0,s.mdx)("p",null,"Proceed to the authentication method for your preferred client:"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("p",{parentName:"li"},"Mobile application. ",(0,s.mdx)("a",{parentName:"p",href:"./gs-authentication-token.md"},"Token-based authentication"),".")),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("p",{parentName:"li"},"Third-party application. ",(0,s.mdx)("a",{parentName:"p",href:"./gs-authentication-oauth.md"},"OAuth-based authentication"),".")),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("p",{parentName:"li"},"JavaScript ",(0,s.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/widget"},"widget")," on the Admin or ",(0,s.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/storefront"},"storefront"),". ",(0,s.mdx)("a",{parentName:"p",href:"./gs-authentication-session.md"},"Session-based authentication"),".")),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("p",{parentName:"li"},(0,s.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/commerce/php/development/components/attributes/"},"Extension attribute authentication"))),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("p",{parentName:"li"},(0,s.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/commerce/php/development/components/web-api/services/"},"Configure services as web APIs"))),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("p",{parentName:"li"},(0,s.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/commerce/php/tutorials/backend/create-access-control-list-rule/"},"Create an ACL rule")))))}p.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-get-started-authentication-index-md-0ecb650ad9356209fc96.js.map