{"version":3,"file":"component---src-pages-graphql-usage-staging-queries-md-555b6bdc0e5278bb3fb0.js","mappings":"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","sources":["webpack://commerce-webapi/./src/pages/graphql/usage/staging-queries.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/commerce-webapi/commerce-webapi/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"staging-queries\"\n    }}>{`Staging queries`}</h1>\n    <p>{`GraphQL allows you to use certain queries to return preview information for staged content. Staging, a Adobe Commerce feature, allows merchants to schedule a set of changes to the storefront that run for a prescribed time in the future. These changes, also known as a `}<em parentName=\"p\">{`campaign`}</em>{`, are defined within the Admin. Customers do not have access to staged content, and as a result, staging queries have requirements that do not apply to traditional queries and mutations.`}</p>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://docs.magento.com/m2/ee/user_guide/cms/content-staging.html\"\n      }}>{`Content Staging`}</a>{` in the `}<em parentName=\"p\">{`Merchant User Guide`}</em>{` describes how to create a campaign.`}</p>\n    <p>{`You can use the following queries to return staged preview information.`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`categoryList`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`products`}</inlineCode></li>\n    </ul>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`The `}<inlineCode parentName=\"p\">{`products`}</inlineCode>{` query does not support full text search in the context of staging, because staged content is not indexed. Therefore, omit the `}<inlineCode parentName=\"p\">{`search`}</inlineCode>{` input attribute in your staging `}<inlineCode parentName=\"p\">{`products`}</inlineCode>{` queries.`}</p>\n    <p>{`A staging query requires two specialized headers:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Header name`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`Authorization Bearer: <authorization_token>`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`An admin token. Use a 2FA REST endpoint such as  `}<inlineCode parentName=\"td\">{`POST /V1/tfa/provider/google/authenticate`}</inlineCode>{` to generate this token.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`Preview-Version`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`A timestamp (seconds since January 1, 1970) that is inside the range of dates of the campaign you are querying.`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`The application returns an authorization error if you specify an invalid token or do not include both headers. If the specified timestamp does not correspond to a date in a scheduled campaign, the query results reflect the current storefront settings.`}</p>\n    <p>{`The application also returns an error if you specify these headers with any other query or any mutation.`}</p>\n    <h2 {...{\n      \"id\": \"example-campaign\"\n    }}>{`Example campaign`}</h2>\n    <p>{`The example staging queries in this section are based on a simple campaign that creates a custom category and catalog sales rule using the Luma sample data. By default, the custom category and sales rule are disabled but become enabled when the campaign takes effect.`}</p>\n    <p>{`The following steps describe how to create this example campaign.`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Create a subcategory of `}<strong parentName=\"li\">{`Sale`}</strong>{` named `}<strong parentName=\"li\">{`End of Year Sale`}</strong>{`. Set the `}<strong parentName=\"li\">{`Enable Category`}</strong>{` field to `}<strong parentName=\"li\">{`No`}</strong>{`.`}</li>\n      <li parentName=\"ol\">{`Add several products to the subcategory.`}</li>\n      <li parentName=\"ol\">{`Schedule an update named `}<strong parentName=\"li\">{`End of Year Sale Update`}</strong>{` for the subcategory that takes effect at a later date. Configure the update so that the `}<strong parentName=\"li\">{`Enable Category`}</strong>{` field is set to `}<strong parentName=\"li\">{`Yes`}</strong>{`.`}</li>\n      <li parentName=\"ol\">{`Create a catalog sales rule with the following properties:`}\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`Set the `}<strong parentName=\"li\">{`Active`}</strong>{` switch to `}<strong parentName=\"li\">{`No`}</strong>{`.`}</li>\n          <li parentName=\"ul\">{`In the `}<strong parentName=\"li\">{`Conditions`}</strong>{` section, define the condition as `}<strong parentName=\"li\">{`Category is <Subcategory_ID>`}</strong>{`.`}</li>\n          <li parentName=\"ul\">{`In the `}<strong parentName=\"li\">{`Actions`}</strong>{` section, set the `}<strong parentName=\"li\">{`Apply`}</strong>{` field to `}<strong parentName=\"li\">{`Apply a percentage of original`}</strong>{` and the `}<strong parentName=\"li\">{`Discount Amount`}</strong>{` field to `}<strong parentName=\"li\">{`25`}</strong>{`.`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">{`Schedule an update for the catalog sales rule and assign it to the `}<strong parentName=\"li\">{`End of Year Sale Update`}</strong>{`. In this update, set the `}<strong parentName=\"li\">{`Active`}</strong>{` switch to `}<strong parentName=\"li\">{`Yes`}</strong>{`.`}</li>\n    </ol>\n    <h3 {...{\n      \"id\": \"staging-products-query\"\n    }}>{`Staging `}<inlineCode parentName=\"h3\">{`products`}</inlineCode>{` query`}</h3>\n    <p>{`The following query returns information about a product (`}<inlineCode parentName=\"p\">{`24-UG05`}</inlineCode>{`) in the `}<strong parentName=\"p\">{`End of Year Sale`}</strong>{` campaign. The `}<inlineCode parentName=\"p\">{`Preview-Version`}</inlineCode>{` header contains the timestamp for a date that is within the duration of the campaign. When you include the proper headers, the query returns prices with applied discounts. Without the headers, the query returns only default prices.`}</p>\n    <p><strong parentName=\"p\">{`Headers:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-text\"\n      }}>{`Authorization: Bearer hoyz7k697ubv5hcpq92yrtx39i7x10um\nPreview-Version: 1576389600\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Request:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`{\n  products(filter: {sku: {eq: \"24-UG05\"}}) {\n    items {\n      name\n      sku\n      price_range {\n        minimum_price {\n          discount {\n            percent_off\n            amount_off\n          }\n          final_price {\n            value\n            currency\n          }\n          regular_price {\n            value\n          }\n        }\n      }\n    }\n  }\n}\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Response with headers:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"data\": {\n    \"products\": {\n      \"items\": [\n        {\n          \"name\": \"Go-Get'r Pushup Grips\",\n          \"sku\": \"24-UG05\",\n          \"price_range\": {\n            \"minimum_price\": {\n              \"discount\": {\n                \"percent_off\": 25,\n                \"amount_off\": 4.75\n              },\n              \"final_price\": {\n                \"value\": 14.25,\n                \"currency\": \"USD\"\n              },\n              \"regular_price\": {\n                \"value\": 19\n              }\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Response without headers:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"data\": {\n    \"products\": {\n      \"items\": [\n        {\n          \"name\": \"Go-Get'r Pushup Grips\",\n          \"sku\": \"24-UG05\",\n          \"price_range\": {\n            \"minimum_price\": {\n              \"discount\": {\n                \"percent_off\": 0,\n                \"amount_off\": 0\n              },\n              \"final_price\": {\n                \"value\": 19,\n                \"currency\": \"USD\"\n              },\n              \"regular_price\": {\n                \"value\": 19\n              }\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"staging-categorylist-query\"\n    }}>{`Staging `}<inlineCode parentName=\"h3\">{`categoryList`}</inlineCode>{` query`}</h3>\n    <p>{`In this example campaign, the `}<strong parentName=\"p\">{`End of Year Sale`}</strong>{` subcategory and a catalog price rule are disabled when the campaign is not in effect. When you specify valid headers, the `}<inlineCode parentName=\"p\">{`categoryList`}</inlineCode>{`query returns full details about the custom category. Otherwise, the query returns an empty array.`}</p>\n    <p><strong parentName=\"p\">{`Headers:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-text\"\n      }}>{`Authorization: Bearer hoyz7k697ubv5hcpq92yrtx39i7x10um\nPreview-Version: 1576389600\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Request:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`{\n  categoryList(filters: {ids: {eq: \"43\"}}) {\n    name\n    level\n    products(\n      sort: {\n        price: ASC\n      }\n      pageSize: 20\n      currentPage: 1\n    ) {\n      total_count\n      items {\n        name\n        sku\n        price_range {\n          minimum_price {\n            discount {\n              amount_off\n              percent_off\n            }\n            final_price {\n              value\n            }\n            regular_price {\n              value\n            }\n          }\n        }\n      }\n    }\n  }\n}\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Response with headers:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"data\": {\n    \"categoryList\": [\n      {\n        \"name\": \"End of Year Sale\",\n        \"level\": 3,\n        \"products\": {\n          \"total_count\": 4,\n          \"items\": [\n            {\n              \"name\": \"Solo Power Circuit\",\n              \"sku\": \"240-LV07\",\n              \"price_range\": {\n                \"minimum_price\": {\n                  \"discount\": {\n                    \"amount_off\": 3.5,\n                    \"percent_off\": 25\n                  },\n                  \"final_price\": {\n                    \"value\": 10.5\n                  },\n                  \"regular_price\": {\n                    \"value\": 14\n                  }\n                }\n              }\n            },\n            {\n              \"name\": \"Quest Lumaflex&trade; Band\",\n              \"sku\": \"24-UG01\",\n              \"price_range\": {\n                \"minimum_price\": {\n                  \"discount\": {\n                    \"amount_off\": 4.75,\n                    \"percent_off\": 25\n                  },\n                  \"final_price\": {\n                    \"value\": 14.25\n                  },\n                  \"regular_price\": {\n                    \"value\": 19\n                  }\n                }\n              }\n            },\n            {\n              \"name\": \"Go-Get'r Pushup Grips\",\n              \"sku\": \"24-UG05\",\n              \"price_range\": {\n                \"minimum_price\": {\n                  \"discount\": {\n                    \"amount_off\": 4.75,\n                    \"percent_off\": 25\n                  },\n                  \"final_price\": {\n                    \"value\": 14.25\n                  },\n                  \"regular_price\": {\n                    \"value\": 19\n                  }\n                }\n              }\n            },\n            {\n              \"name\": \"Gabrielle Micro Sleeve Top\",\n              \"sku\": \"WS02\",\n              \"price_range\": {\n                \"minimum_price\": {\n                  \"discount\": {\n                    \"amount_off\": 7.00,\n                    \"percent_off\": 25\n                  },\n                  \"final_price\": {\n                    \"value\": 21\n                  },\n                  \"regular_price\": {\n                    \"value\": 28\n                  }\n                }\n              }\n            }\n          ]\n        }\n      }\n    ]\n  }\n}\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Response without headers:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"data\": {\n    \"categoryList\": []\n  }\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["name","_frontmatter","InlineAlert","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","variant","slots","isMDXComponent"],"sourceRoot":""}