{"version":3,"file":"component---src-pages-get-started-rate-limiting-md-20833c2ab2f5ac30a9a1.js","mappings":"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","sources":["webpack://commerce-webapi/./src/pages/get-started/rate-limiting.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/commerce-webapi/commerce-webapi/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"rate-limiting\"\n    }}>{`Rate limiting`}</h1>\n    <p>{`In a carding attack, an attacker tries to determine which credit card numbers are valid, usually in batches of thousands. Attackers can use similar techniques to brute force missing details, such as the expiration date. Adobe Commerce merchants can be targeted by this attack type through their shops and integrations with third-party payment gateways.`}</p>\n    <p>{`As of Adobe Commerce 2.4.7, you can configure rate limiting for the payment information transmitted using REST and GraphQL. This added layer of protection allows merchants to prevent and decrease the volume of carding attacks that test many credit card numbers at once.`}</p>\n    <p>{`The rate limiting functionality affects the following entry points:`}</p>\n    <p>{`REST:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`<base_url>/rest/V1/<store_code>/guest-carts/<cart_id>/payment-information`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`<base_url>/rest/V1/<store_code>/guest-carts/<cart_id>/order`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`<base_url>/rest/V1/<store_code>/carts/mine/payment-information`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`<base_url>/rest/V1/<store_code>/carts/mine/order`}</inlineCode></li>\n    </ul>\n    <p>{`GraphQL:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`<base_url>/graphql`}</inlineCode></li>\n    </ul>\n    <p>{`InstantPurchase module:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`magento/module-instant-purchase`}</inlineCode></li>\n    </ul>\n    <p>{`Setting up rate limiting has two discrete steps:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Add a configuration that connects to the service where the request logs will be stored. By default, the connection is configured for a Redis server. Most merchants must configure a cloud or local installation of Redis to implement the rate limiting feature. However, merchants who have `}<a parentName=\"p\" {...{\n            \"href\": \"#use-aws-elasticache-with-your-ec2-instance\"\n          }}>{`instances hosted on Amazon EC2`}</a>{` use an AWS ElastiCache instead of a cloud or local Redis instance.`}</p>\n        <p parentName=\"li\"><strong parentName=\"p\">{`Note:`}</strong>{` The data, including request time and identifier, is temporarily stored in Redis. Registered users are identified by their user ID. Non-registered users are identified by their external IP address.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Configure Commerce to set restrictions on guest users and authenticated customers. This step is the same for all merchants.`}</p>\n      </li>\n    </ol>\n    <h2 {...{\n      \"id\": \"set-the-redis-service-connection-most-merchants\"\n    }}>{`Set the Redis service connection (most merchants)`}</h2>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://experienceleague.adobe.com/docs/commerce-operations/configuration-guide/cache/redis/config-redis.html\"\n      }}>{`Configure Redis`}</a>{` topic in the `}<em parentName=\"p\">{`Commerce Configuration Guide`}</em>{` describes basic installation and configuration information.`}</p>\n    <p>{`Commerce provides command-line options to configure the connection to the backpressure logger. Although you can configure the backpressure logger by editing the `}<inlineCode parentName=\"p\">{`<Commerce-install-dir>/app/etc/env.php`}</inlineCode>{` file, using the command line is the recommended method, especially for initial configurations. The command line provides validation, ensuring the configuration is syntactically correct.`}</p>\n    <p>{`By default, the connection is configured for a Redis server. Use the following `}<inlineCode parentName=\"p\">{`bin/magento setup:config:set`}</inlineCode>{` commands to configure the Redis service connection:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Command line parameter`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Value`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Default`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--backpressure-logger`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`redis`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Specifies the backpressure logger handler`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`This value must be set to `}<inlineCode parentName=\"td\">{`redis`}</inlineCode>{`.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--backpressure-logger-id-prefix`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`String`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`ID prefix for keys`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`None`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--backpressure-logger-redis-db`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Database number`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Required if you use Redis for both the default and full-page cache. You must specify the database number of one of the caches; the other cache uses 0 by default.`}<br /><br /><strong parentName=\"td\">{`Important`}</strong>{`: If you use Redis for more than one type of caching, the database numbers must be different. It is recommended that you assign the default caching database number to 0, the page-caching database number to 1, and the session storage database number to 2. And as a result, the number of the database for storing the backpressure log is 3.`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`3`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--backpressure-logger-redis-password`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Password`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Configuring a Redis password enables one of its built-in security features: the `}<inlineCode parentName=\"td\">{`auth`}</inlineCode>{` command, which requires clients to authenticate to access the database. The password is configured directly in Redis' configuration file: `}<inlineCode parentName=\"td\">{`/etc/redis/redis.conf`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`None`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--backpressure-logger-redis-persistent`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`String`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Unique string to enable persistent connections`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`None`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--backpressure-logger-redis-port`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Port`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Redis server listen port`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`6379`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--backpressure-logger-redis-server`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Server`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Fully qualified hostname, IP address, or an absolute path to a UNIX socket. The default value of 127.0.0.1 indicates Redis is installed on the Commerce server.`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`127.0.0.1`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--backpressure-logger-redis-timeout`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Timeout`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Redis server timeout, in seconds`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`2.5`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`--backpressure-logger-redis-user`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`User ID`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Redis server user`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`None`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`The following example creates a new connection to a Redis server with the following properties:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Host: 195.34.23.5`}</li>\n      <li parentName=\"ul\">{`Port: 9345`}</li>\n      <li parentName=\"ul\">{`Password: s0M3StR0NgP@SsW0Rd`}</li>\n      <li parentName=\"ul\">{`User: SomeUser`}</li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`$ bin/magento setup:config:set \\\\\n    --backpressure-logger=redis \\\\\n    --backpressure-logger-redis-server=195.34.23.5 \\\\\n    --backpressure-logger-redis-port=9345 \\\\\n    --backpressure-logger-redis-timeout=1 \\\\\n    --backpressure-logger-redis-persistent=persistent \\\\\n    --backpressure-logger-redis-db=3 \\\\\n    --backpressure-logger-redis-password=s0M3StR0NgP@SsW0Rd\\\\\n    --backpressure-logger-redis-user=SomeUser \\\\\n    --backpressure-logger-id-prefix=some_pref\n`}</code></pre>\n    <p>{`After the command is executed, the following configuration is added to the `}<inlineCode parentName=\"p\">{`app/etc/env.php`}</inlineCode>{` file.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`[\n//...\n    'backpressure' => [\n        'logger' => [\n            'type' => 'redis',\n            'options' => [\n                'server' => '195.34.23.5',\n                'port' => 9345,\n                'timeout' => 1,\n                'persistent' => 'persistent',\n                'db' => '3',\n                'password' => 's0meStr0ngPassw0rd',\n                'user' => 'SomeUser'\n            ],\n            'id-prefix' => 'some_pref'\n        ]\n    ]\n//...\n];\n`}</code></pre>\n    <p>{`Continue to `}<a parentName=\"p\" {...{\n        \"href\": \"#configure-rate-limiting\"\n      }}>{`Configure rate limiting`}</a></p>\n    <h2 {...{\n      \"id\": \"use-aws-elasticache-with-your-ec2-instance\"\n    }}>{`Use AWS ElastiCache with your EC2 instance`}</h2>\n    <p>{`As of Commerce 2.4.3, instances hosted on Amazon EC2 can use an AWS ElastiCache in place of a local Redis instance.`}</p>\n    <InlineAlert variant=\"warning\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`This section applies to Commerce instances running on Amazon EC2 VPCs. It does not work for standard cloud or on-premises installations.`}</p>\n    <h3 {...{\n      \"id\": \"configure-a-redis-cluster\"\n    }}>{`Configure a Redis cluster`}</h3>\n    <p>{`After `}<a parentName=\"p\" {...{\n        \"href\": \"https://aws.amazon.com/getting-started/hands-on/setting-up-a-redis-cluster-with-amazon-elasticache/\"\n      }}>{`setting up a Redis cluster on AWS`}</a>{`, configure the EC2 instance to use the ElastiCache.`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\"><a parentName=\"p\" {...{\n            \"href\": \"https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/set-up.html\"\n          }}>{`Create an ElastiCache Cluster`}</a>{` in the same region and VPC of the EC2 instance.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Verify the connection.`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">\n            <p parentName=\"li\">{`Open an SSH connection to your EC2 instance.`}</p>\n          </li>\n          <li parentName=\"ul\">\n            <p parentName=\"li\">{`On the EC2 instance, install the Redis client:`}</p>\n            <pre parentName=\"li\"><code parentName=\"pre\" {...{\n                \"className\": \"language-bash\"\n              }}>{`sudo apt-get install redis\n`}</code></pre>\n          </li>\n          <li parentName=\"ul\">\n            <p parentName=\"li\">{`Add an inbound rule to the EC2 security group: Type `}<inlineCode parentName=\"p\">{`- Custom TCP, port - 6379, Source - 0.0.0.0/0`}</inlineCode></p>\n          </li>\n          <li parentName=\"ul\">\n            <p parentName=\"li\">{`Add an inbound rule to the ElastiCache Cluster security group: Type `}<inlineCode parentName=\"p\">{`- Custom TCP, port - 6379, Source - 0.0.0.0/0`}</inlineCode></p>\n          </li>\n          <li parentName=\"ul\">\n            <p parentName=\"li\">{`Connect to the Redis CLI:`}</p>\n            <pre parentName=\"li\"><code parentName=\"pre\" {...{\n                \"className\": \"language-bash\"\n              }}>{`redis-cli -h <ElastiCache Primary Endpoint host> -p <ElastiCache Primary Endpoint port>\n`}</code></pre>\n          </li>\n        </ul>\n      </li>\n    </ol>\n    <h3 {...{\n      \"id\": \"configure-commerce-to-use-the-cluster\"\n    }}>{`Configure Commerce to use the cluster`}</h3>\n    <p>{`Run `}<inlineCode parentName=\"p\">{`setup`}</inlineCode>{` commands to specify the Redis endpoints.\nTo configure Commerce for the backpressure logger connection:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`bin/magento setup:config:set --backpressure-logger=redis --backpressure-logger-redis-server=<ElastiCache Primary Endpoint host> --backpressure-logger-redis-port=<ElastiCache Primary Endpoint port> --backpressure-logger-redis-db=3\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"configure-rate-limiting\"\n    }}>{`Configure rate limiting`}</h2>\n    <p>{`After the Redis server connection has been configured, you can run several `}<inlineCode parentName=\"p\">{`bin/magento config:set`}</inlineCode>{` commands that define how rate limiting is implemented for guest users and authenticated customers. Rate limiting is disabled by default.`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Parameter`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`sales/backpressure/enabled`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Enable rate limiting for placing orders.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`sales/backpressure/disabled`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Disable the rate limiting feature.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`sales/backpressure/guest_limit`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Requests limit per guest.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`sales/backpressure/limit`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Requests limit per authenticated customer.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`sales/backpressure/period`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The number of seconds to wait until resetting the counter.`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`You can also enable and configure rate limiting from the Admin by selecting `}<strong parentName=\"p\">{`Stores`}</strong>{` > `}<strong parentName=\"p\">{`Configuration`}</strong>{` > `}<strong parentName=\"p\">{`Sales`}</strong>{` > `}<strong parentName=\"p\">{`Sales`}</strong>{` > `}<strong parentName=\"p\">{`Rate Limiting`}</strong>{`.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1181px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"81.5625%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-webapi/static/17d69ee58bc3bd0af5e074882be7df99/5530d/api-security-rate-limiting.webp 320w\", \"/commerce-webapi/static/17d69ee58bc3bd0af5e074882be7df99/0c8fb/api-security-rate-limiting.webp 640w\", \"/commerce-webapi/static/17d69ee58bc3bd0af5e074882be7df99/8866f/api-security-rate-limiting.webp 1181w\"],\n            \"sizes\": \"(max-width: 1181px) 100vw, 1181px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-webapi/static/17d69ee58bc3bd0af5e074882be7df99/dd4a7/api-security-rate-limiting.png 320w\", \"/commerce-webapi/static/17d69ee58bc3bd0af5e074882be7df99/0f09e/api-security-rate-limiting.png 640w\", \"/commerce-webapi/static/17d69ee58bc3bd0af5e074882be7df99/f6909/api-security-rate-limiting.png 1181w\"],\n            \"sizes\": \"(max-width: 1181px) 100vw, 1181px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/commerce-webapi/static/17d69ee58bc3bd0af5e074882be7df99/f6909/api-security-rate-limiting.png\",\n            \"alt\": \"Rate limiting section\",\n            \"title\": \"Rate limiting section\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`Use the following commands to enable and configure rate limiting:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Enable (`}<inlineCode parentName=\"p\">{`1`}</inlineCode>{`) or disable (`}<inlineCode parentName=\"p\">{`0`}</inlineCode>{`) rate limiting for placing orders:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`$ bin/magento config:set sales/backpressure/enabled 1\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Set the request limit per guest (IP address).`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`$ bin/magento config:set sales/backpressure/guest_limit 50\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Set the request limit for authenticated customers:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`$ bin/magento config:set sales/backpressure/limit 10\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Set the period of time (in seconds) for the request limit. Supported values `}<inlineCode parentName=\"p\">{`60`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`3600`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`86400`}</inlineCode>{` seconds. This time period is multiplied by three to calculate the timeout period:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`$ bin/magento config:set sales/backpressure/period 60\n`}</code></pre>\n      </li>\n    </ol>\n    <p>{`The following scenario describes how rate limiting can be configured.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Anonymous users are limited to 50 orders (`}<inlineCode parentName=\"li\">{`sales/backpressure/guest_limit`}</inlineCode>{` = `}<inlineCode parentName=\"li\">{`50`}</inlineCode>{`) from a single IP address within one minute (`}<inlineCode parentName=\"li\">{`sales/backpressure/period`}</inlineCode>{` = `}<inlineCode parentName=\"li\">{`60`}</inlineCode>{`).  If they exceed the order limit, then they will have to wait three times the specified `}<inlineCode parentName=\"li\">{`period`}</inlineCode>{` of time (`}<inlineCode parentName=\"li\">{`180`}</inlineCode>{` seconds) from their last request.`}</li>\n      <li parentName=\"ul\">{`If an authorized customers attempts to place more than `}<inlineCode parentName=\"li\">{`10`}</inlineCode>{` orders (`}<inlineCode parentName=\"li\">{`sales/backpressure/limit`}</inlineCode>{` = `}<inlineCode parentName=\"li\">{`10`}</inlineCode>{`) within the `}<inlineCode parentName=\"li\">{`period`}</inlineCode>{` of `}<inlineCode parentName=\"li\">{`60`}</inlineCode>{` seconds, then the user will not be able to place an order for a period of `}<inlineCode parentName=\"li\">{`180`}</inlineCode>{` seconds.`}</li>\n    </ul>\n    <p>{`If you need to check a configuration, use the following CLI command:`}</p>\n    <p>{`Example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`$ bin/magento config:show | grep backpressure\n`}</code></pre>\n    <p>{`Response:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-terminal\"\n      }}>{`sales/backpressure/limit - 10\nsales/backpressure/guest_limit - 50\nsales/backpressure/period - 60\nsales/backpressure/enabled - 1\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"log-contents\"\n    }}>{`Log contents`}</h2>\n    <p>{`If rate limiting has been enabled for the payment information endpoint and the GraphQL mutation via the UI/CLI, but the Redis service connection for store log requests has not been configured in the `}<inlineCode parentName=\"p\">{`app/etc/env.php`}</inlineCode>{` file, then the rate-limiting will not apply. The behavior will be the same if this option is disabled, but the application logs (`}<inlineCode parentName=\"p\">{`<magento-root>/var/log/system.log`}</inlineCode>{`) will contain the following message:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-text\"\n      }}>{`...\n[2022-11-11T15:46:32.716679+00:00] main.ERROR: Backpressure sliding window not applied. Invalid request logger type:  [] []\n...\n[2022-11-11T15:46:37.730863+00:00] main.ERROR: Backpressure sliding window not applied. Invalid request logger type:  [] []\n...\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"example-http-responses\"\n    }}>{`Example HTTP Responses`}</h2>\n    <p>{`If rate limiting is applied to a REST request, then a response with HTTP status code `}<inlineCode parentName=\"p\">{`429 - Too Many Requests`}</inlineCode>{` will be generated.`}</p>\n    <p>{`Example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-text\"\n      }}>{`HTTP/1.1 429 Too Many Requests\n...\nPragma: no-cache\nCache-Control: no-store\n...\n{\"message\":\"Too Many Requests\",\"trace\":null}\n`}</code></pre>\n    <p>{`If rate limiting is applied to a GraphQL request, then a response with HTTP status code `}<inlineCode parentName=\"p\">{`200 - Ok`}</inlineCode>{` will be generated and all relevant information will be present in the response body.`}</p>\n    <p>{`Example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-text\"\n      }}>{`HTTP/1.1 200 OK\n...\nPragma: no-cache\nCache-Control: max-age=0, must-revalidate, no-cache, no-store\n ...\n{\n    \"errors\":[\n        {\n            \"message\":\"Too Many Requests\",\n            \"extensions\":{\"category\":\"graphql-too-many-requests\"},\n             \"locations\":[\n                 {\"line\":2,\"column\":3}\n             ],\n             \"path\":[\"placeOrder\"]\n        }\n    ],\n    \"data\":{\"placeOrder\":null}\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","InlineAlert","name","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","variant","slots","isMDXComponent"],"sourceRoot":""}