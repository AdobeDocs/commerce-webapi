{"version":3,"file":"component---src-pages-get-started-authentication-gs-authentication-token-md-34e442f1fb41bcb3524b.js","mappings":"oRAMaA,EAAe,CAAC,EACvBC,EAAc,CAClBD,aAAAA,GAEIE,EAAYC,EAAAA,EACH,SAASC,EAAW,GAGhC,IAFDC,EAAU,EAAVA,WACGC,GAAK,YAER,OAAO,SAACJ,GAAS,UAAKD,EAAiBK,EAAK,CAAED,WAAYA,EAAYE,QAAQ,eAG5E,eACE,GAAM,8BAA4B,+BAEpC,4GAA6F,eAAIC,WAAW,KAAG,gBAAsB,sFACrI,yGACA,uBACE,kBAAOA,WAAW,UAChB,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,eAEf,eAAIA,WAAW,KACb,MAAS,MAAI,gBAEf,eAAIA,WAAW,KACb,MAAS,MAAI,uBAInB,kBAAOA,WAAW,UAChB,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,gBAEf,eAAIA,WAAW,KACb,MAAS,MAAI,iFAEf,eAAIA,WAAW,KACb,MAAS,MAAI,wDAGjB,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,UAEf,eAAIA,WAAW,KACb,MAAS,MAAI,kFAEf,eAAIA,WAAW,KACb,MAAS,MAAI,aAGjB,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,aAEf,eAAIA,WAAW,KACb,MAAS,MAAI,iDACqC,uBAAYA,WAAW,MAAI,aAA2B,QAAQ,uBAAYA,WAAW,MAAI,QAAsB,uDACnK,eAAIA,WAAW,KACb,MAAS,MAAI,cAKrB,eACE,GAAM,sBAAoB,uBAE5B,0MAA2L,cAAGA,WAAW,IACrM,KAAQ,gCAA8B,8BACH,MACvC,gVACA,sHAAuG,mBAAQA,WAAW,KAAG,UAAoB,OAAO,mBAAQA,WAAW,KAAG,iBAA2B,OAAO,mBAAQA,WAAW,KAAG,YAAsB,OAAO,mBAAQA,WAAW,KAAG,SAAmB,OAAO,mBAAQA,WAAW,KAAG,qBAA+B,OAAO,mBAAQA,WAAW,KAAG,oEAA8E,eAAe,mBAAQA,WAAW,KAAG,OAAiB,sFACzgB,qBAAK,iBAAMA,WAAW,MAClB,UAAa,iBAAe,4EAGhC,6KAA8J,cAAGA,WAAW,IACxK,KAAQ,gCAA8B,8BACH,mIACvC,6VACA,oBACA,yBACE,yBAAS,6CACT,qBAAK,iBAAMA,WAAW,MAClB,UAAa,gBAAc,4hIAsHjC,eACE,GAAM,oCAAkC,qCAE1C,sPACA,mDAAoC,eAAIA,WAAW,KAAG,eAAqB,2TAA2T,cAAGA,WAAW,IAChZ,KAAQ,qFAAmF,4CAC1C,0DACrD,oKAAqJ,cAAGA,WAAW,IAC/J,KAAQ,wGAAsG,6BAC5E,0DACtC,uBACE,kBAAOA,WAAW,UAChB,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,eAEf,eAAIA,WAAW,KACb,MAAS,MAAI,SAEf,eAAIA,WAAW,KACb,MAAS,MAAI,WAInB,kBAAOA,WAAW,UAChB,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,oCAEf,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,+CAC9B,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,wCAEhC,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,4BAEf,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,qDAC9B,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,qCAEhC,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,qBAEf,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,8CAC9B,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,uCAEhC,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,mBAEf,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,yCAC9B,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,wCAEhC,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,aAEf,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,yCAC9B,eAAIA,WAAW,KACb,MAAS,OACR,uBAAYA,WAAW,MAAI,0CAIpC,2EAA4D,uBAAYA,WAAW,KAAG,iBAA+B,6BAA6B,uBAAYA,WAAW,KAAG,UAAwB,wMAAwM,mBAAQA,WAAW,KAAG,UAAoB,OAAO,mBAAQA,WAAW,KAAG,YAAsB,OAAO,mBAAQA,WAAW,KAAG,iBAA2B,OAAO,mBAAQA,WAAW,KAAG,YAAsB,OAAO,mBAAQA,WAAW,KAAG,SAAmB,OAAO,mBAAQA,WAAW,KAAG,2BAAqC,MACtsB,8EACA,eACE,GAAM,uCAAqC,wCAE7C,8MACA,eACE,GAAM,0DAAwD,2DAEhE,6DAA8C,uBAAYA,WAAW,KAAG,qBAAmC,kBAAkB,uBAAYA,WAAW,KAAG,0BAAwC,0JAC/L,eACE,GAAM,2BAAyB,4BAEjC,sPAAuO,uBAAYA,WAAW,KAAG,cAA4B,kBAAkB,uBAAYA,WAAW,KAAG,0BAAwC,YACjX,eACE,GAAM,2DAAyD,4DAEjE,+MACA,mBAAG,uBAAYA,WAAW,KAAG,yBAAuC,qDAAqD,uBAAYA,WAAW,KAAG,8DAA4E,aAC/N,mBAAG,uBAAYA,WAAW,KAAG,sBAAoC,uBAAuB,uBAAYA,WAAW,KAAG,gBAA8B,0CAChJ,0BAAW,uBAAYA,WAAW,KAAG,8DAA4E,0BAA0B,uBAAYA,WAAW,KAAG,yBAAuC,oCAAoC,uBAAYA,WAAW,KAAG,yBAAuC,4LAA4L,uBAAYA,WAAW,KAAG,yBAAuC,iGAC9iB,eACE,GAAM,mBAAiB,oBAEzB,4EACA,uBACE,kBAAOA,WAAW,UAChB,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,cAEf,eAAIA,WAAW,KACb,MAAS,MAAI,gBAInB,kBAAOA,WAAW,UAChB,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,aAEf,eAAIA,WAAW,KACb,MAAS,MAAI,yBACa,eAAIA,WAAW,MAAI,UAAgB,yDAAyD,uBAAYA,WAAW,MAAI,YAA0B,6CAA6C,qBAAM,oBAAM,wBAAwB,uBAAYA,WAAW,MAAI,+DAA6E,cAAc,oBAAM,kBAAkB,uBAAYA,WAAW,MAAI,2BAAyC,KAAK,oBAAM,wBAAwB,uBAAYA,WAAW,MAAI,QAAsB,KAAK,oBAAM,yBAAyB,uBAAYA,WAAW,MAAI,kCAAgD,OAErpB,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,iBAEf,eAAIA,WAAW,KACb,MAAS,MAAI,mEACuD,uBAAYA,WAAW,MAAI,mCAAiD,QAAQ,uBAAYA,WAAW,MAAI,kCAAgD,OAEvO,eAAIA,WAAW,UACb,eAAIA,WAAW,KACb,MAAS,MAAI,gBAEf,eAAIA,WAAW,KACb,MAAS,MAAI,qDACyC,qBAAM,oBAAM,4GAA4G,qBAAM,qBAAM,uBAAYA,WAAW,MAAI,yDAAsE,qBAAM,oBAAM,2FAA2F,qBAAM,qBAAM,uBAAYA,WAAW,MAAI,sFAIjb,eACE,GAAM,YAAU,aAElB,2GACA,mBAAG,iBAAMA,WAAW,IAChB,UAAa,4BACb,MAAS,CACP,SAAY,WACZ,QAAW,QACX,WAAc,OACd,YAAe,OACf,SAAY,WACb,YAED,iBAAMA,WAAW,OACf,UAAa,qCACb,MAAS,CACP,cAAiB,UACjB,SAAY,WACZ,OAAU,IACV,KAAQ,IACR,QAAW,QACX,WAAc,oBACd,cAAiB,UAEX,QACd,oBAASA,WAAW,QAAM,gBAClB,mBAAQA,WAAW,UACnB,OAAU,CAAC,0FAA2F,0FAA2F,2FAA4F,2FAA4F,4FACzX,MAAS,oCACT,KAAQ,eACE,gBACV,mBAAQA,WAAW,UACnB,OAAU,CAAC,yFAA0F,yFAA0F,0FAA2F,0FAA2F,2FACrX,MAAS,oCACT,KAAQ,cACE,gBACV,gBAAKA,WAAW,UAChB,UAAa,0BACb,IAAO,oFACP,IAAO,cACP,MAAS,cACT,QAAW,OACX,MAAS,CACP,MAAS,OACT,OAAU,OACV,OAAU,IACV,cAAiB,SACjB,SAAY,WACZ,QAAW,IACX,WAAc,eACd,MAAS,UACT,UAAa,+BACb,IAAO,IACP,KAAQ,OAEH,cACC,YAEhB,qDAAsC,uBAAYA,WAAW,KAAG,QAAsB,wDACtF,qBAAK,iBAAMA,WAAW,MAClB,UAAa,iBAAe,gNAKhC,0GACA,qBAAK,iBAAMA,WAAW,MAClB,UAAa,iBAAe,uNAKhC,qDAAsC,uBAAYA,WAAW,KAAG,QAAsB,kBAAkB,cAAGA,WAAW,IAClH,KAAQ,iBAAe,iCAE3B,eACE,GAAM,iCAA+B,kCAEvC,+FACA,mBAAG,uBAAYA,WAAW,KAAG,uBAC7B,eACE,GAAM,sCAAoC,uCAE5C,sOACA,mBAAG,uBAAYA,WAAW,KAAG,kDAC7B,eACE,GAAM,gBAAc,iBAEtB,qFACA,+EACA,mBAAG,uBAAYA,WAAW,KAAG,0GAC7B,eACE,GAAM,mBAAiB,oBAEzB,+DAAgD,uBAAYA,WAAW,KAAG,QAAsB,kBAChG,kFACF,uBAAYA,WAAW,KAAG,2GACxB,eACE,GAAM,kBAAgB,mBAExB,mBAAG,cAAGA,WAAW,IACb,KAAQ,4BAA0B,yBAEtC,mBAAG,cAAGA,WAAW,IACb,KAAQ,qFAAmF,oCAE/F,mBAAG,cAAGA,WAAW,IACb,KAAQ,qFAAmF,6CAInG,CAEAJ,EAAWK,gBAAiB,C","sources":["webpack://commerce-webapi/./src/pages/get-started/authentication/gs-authentication-token.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/commerce-webapi/commerce-webapi/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"token-based-authentication\"\n    }}>{`Token-based authentication`}</h1>\n    <p>{`To make a web API call from a client such as a mobile application, you must supply an `}<em parentName=\"p\">{`access token`}</em>{` on the call. The token acts like an electronic key that lets you access the API.`}</p>\n    <p>{`Adobe Commerce and Magento Open Source issue the following types of access tokens:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Token type`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Default lifetime`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Integration`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The merchant determines which Commerce resources the integration can access.`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Indefinite. It lasts until it is manually revoked.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Admin`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The merchant determines which Commerce resources an admin user has access to.`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`4 hours`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Customer`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Commerce grants access to resources with the `}<inlineCode parentName=\"td\">{`anonymous`}</inlineCode>{` or `}<inlineCode parentName=\"td\">{`self`}</inlineCode>{` permission. Merchants cannot edit these settings.`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`1 hour`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <h2 {...{\n      \"id\": \"integration-tokens\"\n    }}>{`Integration tokens`}</h2>\n    <p>{`When a merchant creates and activates an integration, Commerce generates a consumer key, consumer secret, access token, and access token secret. All of these entities are used for `}<a parentName=\"p\" {...{\n        \"href\": \"./gs-authentication-oauth.md\"\n      }}>{`OAuth-based authentication`}</a>{`.`}</p>\n    <p>{`In previous versions of Commerce, the access token could be used on its own for token-based authentication. This behavior has been disabled by default due to the security implications of a never-expiring access token. Namely, if the access token is compromised it provides undetected persistent access to a store.`}</p>\n    <p>{`However, while it is not recommended, this behavior can be restored in the Admin by setting the `}<strong parentName=\"p\">{`Stores`}</strong>{` > `}<strong parentName=\"p\">{`Configuration`}</strong>{` > `}<strong parentName=\"p\">{`Services`}</strong>{` > `}<strong parentName=\"p\">{`OAuth`}</strong>{` > `}<strong parentName=\"p\">{`Consumer Settings`}</strong>{` > `}<strong parentName=\"p\">{`Allow OAuth Access Tokens to be used as standalone Bearer tokens`}</strong>{` option to `}<strong parentName=\"p\">{`Yes`}</strong>{`. You can also enable this setting from the CLI by running the following command:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`bin/magento config:set oauth/consumer/enable_integration_as_bearer 1\n`}</code></pre>\n    <p>{`If you are trying to upgrade from a previous version and need to update your integration implementation to properly utilize the OAuth workflow, review `}<a parentName=\"p\" {...{\n        \"href\": \"./gs-authentication-oauth.md\"\n      }}>{`OAuth-based Authentication`}</a>{`. Otherwise, you can partially update your integration to simply store and utilize all four credentials to sign your requests.`}</p>\n    <p>{`There is a comprehensive guide for this on the OAuth-based authentication page, but can also be done in isolation without supporting the entire OAuth workflow. For example, in the following script the four credentials are used to create a new CMS page without using external libraries or implementing the full OAuth handshake.`}</p>\n    <p></p>\n    <details>\n      <summary><b>standalone-oauth.php </b></summary>\n      <pre><code parentName=\"pre\" {...{\n          \"className\": \"language-php\"\n        }}>{`<?php\nconst CONSUMER_KEY = '<placeholder>';\nconst CONSUMER_SECRET = '<placeholder>';\nconst ACCESS_TOKEN = '<placeholder>';\nconst ACCESS_TOKEN_SECRET = '<placeholder>';\n\nclass RequestDTO {\n    public function __construct(\n        public string $url,\n        public string $method = 'GET',\n        public ?string $body = null,\n        public array $headers = [],\n    ) {}\n}\nclass OAuthCredentialsDTO {\n    public function __construct(\n        public string $consumerKey,\n        public string $consumerSecret,\n        public string $accessToken,\n        public string $accessTokenSecret\n    ) {}\n}\n\nclass OAuthRequestSigner\n{\n    public function sign(\n        RequestDTO $request,\n        OAuthCredentialsDTO $credentials\n    ): string {\n        $urlParts = parse_url($request->url);\n        // Normalize the OAuth params for the base string\n        $normalizedHeaders = $request->headers;\n        sort($normalizedHeaders);\n        $oauthParams = [\n            'oauth_consumer_key' => $credentials->consumerKey,\n            'oauth_nonce' => base64_encode(random_bytes(32)),\n            'oauth_signature_method' => 'HMAC-SHA256',\n            'oauth_timestamp' => time(),\n            'oauth_token' => $credentials->accessToken\n        ];\n        // Create the base string\n        $signingUrl = $urlParts['scheme'] . '://' . $urlParts['host'] . $urlParts['path'];\n        $paramString = $this->createParamString($urlParts['query'] ?? null, $oauthParams);\n        $baseString = strtoupper($request->method) . '&' . rawurlencode($signingUrl) . '&' . rawurlencode($paramString);\n        // Create the signature\n        $signatureKey = $credentials->consumerSecret . '&' . $credentials->accessTokenSecret;\n        $signature = base64_encode(hash_hmac('sha256', $baseString, $signatureKey, true));\n        return $this->createOAuthHeader($oauthParams, $signature);\n    }\n    private function createParamString(?string $query, array $oauthParams): string\n    {\n        // Create the params string\n        $params = array_merge([], $oauthParams);\n        if (!empty($query)) {\n            foreach (explode('&', $query) as $paramToValue) {\n                $paramData = explode('=', $paramToValue);\n                if (count($paramData) === 2) {\n                    $params[rawurldecode($paramData[0])] = rawurldecode($paramData[1]);\n                }\n            }\n        }\n        ksort($params);\n        $paramString = '';\n        foreach ($params as $param => $value) {\n            $paramString .= rawurlencode($param) . '=' . rawurlencode($value) . '&';\n        }\n        return rtrim($paramString, '&');\n    }\n    private function createOAuthHeader(array $oauthParams, string $signature): string\n    {\n        // Create the OAuth header\n        $oauthHeader = \"Authorization: Oauth \";\n        foreach ($oauthParams as $param => $value) {\n            $oauthHeader .= \"$param=\\\\\"$value\\\\\",\";\n        }\n        return $oauthHeader . \"oauth_signature=\\\\\"$signature\\\\\"\";\n    }\n}\n\nfunction send(RequestDTO $request): string\n{\n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $request->url);\n    curl_setopt($ch, CURLOPT_HEADER, false);\n    curl_setopt($ch, CURLOPT_HTTPHEADER, $request->headers);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, $request->method);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, $request->body ?? '');\n    return (string)curl_exec($ch);\n}\n\n$oauthSigner = new OAuthRequestSigner();\n$request = new RequestDTO(\n    'https://example.com/rest/V1/cmsPage',\n    'POST',\n    '{\n          \"page\": {\n            \"identifier\": \"test-page\",\n            \"title\": \"my-page\",\n            \"content\": \"<h1>hello</h1>\",\n            \"active\": true\n          }\n        }',\n    ['Content-Type: application/json']\n);\n$request->headers[] = $oauthSigner->sign(\n    $request,\n    new OAuthCredentialsDTO(\n        CONSUMER_KEY,\n        CONSUMER_SECRET,\n        ACCESS_TOKEN,\n        ACCESS_TOKEN_SECRET\n    )\n);\necho send($request);\n`}</code></pre>\n    </details>\n    <h2 {...{\n      \"id\": \"admin-and-customer-access-tokens\"\n    }}>{`Admin and customer access tokens`}</h2>\n    <p>{`Commerce provides a separate token service for administrators and customers. When you request a token from one of these services, the service returns a unique access token in exchange for an account's username and password.`}</p>\n    <p>{`The web API framework allows `}<em parentName=\"p\">{`guest users`}</em>{` to access resources that are configured with the permission level of anonymous. Guest users are users who the framework cannot authenticate through existing authentication mechanisms. As a guest user, you do not need to, but you can, specify a token in a web API call for a resource with anonymous permission. `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.adobe.com/commerce/webapi/rest/use-rest/anonymous-api-security/\"\n      }}>{`Restricting access to anonymous web APIs`}</a>{` contains a list of APIs that do not require a token.`}</p>\n    <p>{`The following table lists endpoints and services that can be used to get an authentication token. Admin accounts must be authenticated with a `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.adobe.com/commerce/testing/functional-testing-framework/two-factor-authentication/\"\n      }}>{`two factor authentication`}</a>{` provider. Some providers may require multiple calls.`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Token type`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`REST`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`SOAP`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Admin with Google Authenticator`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`POST /V1/tfa/provider/google/authenticate`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`twoFactorAuthGoogleAuthenticateV1`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Admin with Duo Security`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`POST /V1/tfa/provider/duo-security/authenticate`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`twoFactorAuthDuoAuthenticateV1`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Admin with Authy`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`POST /V1/tfa/provider/authy/authenticate`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`twoFactorAuthAuthyAuthenticateV1`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Admin with U2F`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`POST /V1/tfa/provider/u2fkey/verify`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`twoFactorAuthU2fKeyAuthenticateV1`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Customer`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`POST /V1/integration/customer/token`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`integrationCustomerTokenServiceV1`}</inlineCode></td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`For most web API calls, you supply this token in the `}<inlineCode parentName=\"p\">{`Authorization`}</inlineCode>{` request header with the `}<inlineCode parentName=\"p\">{`Bearer`}</inlineCode>{` HTTP authorization scheme to prove your identity. By default, an admin token is valid for 4 hours, while a customer token is valid for 1 hour. You can change these values from Admin by selecting `}<strong parentName=\"p\">{`Stores`}</strong>{` > `}<strong parentName=\"p\">{`Settings`}</strong>{` > `}<strong parentName=\"p\">{`Configuration`}</strong>{` > `}<strong parentName=\"p\">{`Services`}</strong>{` > `}<strong parentName=\"p\">{`OAuth`}</strong>{` > `}<strong parentName=\"p\">{`Access Token Expiration`}</strong>{`.`}</p>\n    <p>{`A cron job that runs hourly removes all expired tokens.`}</p>\n    <h2 {...{\n      \"id\": \"ims-access-tokens-for-web-api-calls\"\n    }}>{`IMS access tokens for web API calls`}</h2>\n    <p>{`Web API services and events need access tokens to provide authentication credentials to protected resources once the Commerce Admin is integrated with the IMS authentication workflow.`}</p>\n    <h3 {...{\n      \"id\": \"ims-access-tokens-and-the-admin_adobe_ims_webapi-table\"\n    }}>{`IMS access tokens and the admin_adobe_ims_webapi table`}</h3>\n    <p>{`Each IMS access token is defined by an `}<inlineCode parentName=\"p\">{`access_token_hash`}</inlineCode>{` entry in the `}<inlineCode parentName=\"p\">{`admin_adobe_ims_webapi`}</inlineCode>{` table. This table keeps a record of all validated access tokens. When a token is validated or invalidated, a record of its status is preserved here.`}</p>\n    <h3 {...{\n      \"id\": \"access-token-expiration\"\n    }}>{`Access token expiration`}</h3>\n    <p>{`No dependency exists between IMS access token lifetime and Commerce session lifetime. Access token life is set by the Adobe IMS service and has a default value of 24 hours. Each access token's expiration time is saved in an `}<inlineCode parentName=\"p\">{`expires_in`}</inlineCode>{` value in the `}<inlineCode parentName=\"p\">{`admin_adobe_ims_webapi`}</inlineCode>{` table.`}</p>\n    <h3 {...{\n      \"id\": \"commerce-session-management-and-adobe-ims-access-tokens\"\n    }}>{`Commerce session management and Adobe IMS access tokens`}</h3>\n    <p>{`Access tokens hold both user credentials and login session information. Once a user has been authenticated and a session has begun, these two variables are added to the user's session:`}</p>\n    <p><inlineCode parentName=\"p\">{`token_last_check_time`}</inlineCode>{`. Identifies the current time and is used by the `}<inlineCode parentName=\"p\">{`\\\\Magento\\\\AdminAdobeIms\\\\Plugin\\\\BackendAuthSessionPlugin`}</inlineCode>{` plugin.`}</p>\n    <p><inlineCode parentName=\"p\">{`adobe_access_token`}</inlineCode>{` â€” Identifies  the `}<inlineCode parentName=\"p\">{`ACCESS_TOKEN`}</inlineCode>{` value received during authorization.`}</p>\n    <p>{`The `}<inlineCode parentName=\"p\">{`\\\\Magento\\\\AdminAdobeIms\\\\Plugin\\\\BackendAuthSessionPlugin`}</inlineCode>{` plugin checks if the `}<inlineCode parentName=\"p\">{`token_last_check_time`}</inlineCode>{` was updated 10 min ago. If the `}<inlineCode parentName=\"p\">{`token_last_check_time`}</inlineCode>{` was checked ten minutes ago, then the authentication workflow makes an API call to IMS to validate the access token, and the session continues. If the access token is valid, then the `}<inlineCode parentName=\"p\">{`token_last_check_time`}</inlineCode>{` value is updated to the current time. If the token is not valid, the session is terminated.`}</p>\n    <h2 {...{\n      \"id\": \"request-a-token\"\n    }}>{`Request a token`}</h2>\n    <p>{`A access token request contains three basic elements:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Component`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Specifies`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Endpoint`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`A combination of the `}<em parentName=\"td\">{`server`}</em>{` that fulfills the request, the web service, and the `}<inlineCode parentName=\"td\">{`resource`}</inlineCode>{` against which the request is being made.`}<br /><br />{`For example, in the `}<inlineCode parentName=\"td\">{`POST <host>/rest/<store_code>/V1/integration/customer/token`}</inlineCode>{` endpoint:`}<br />{`The server is `}<inlineCode parentName=\"td\">{`magento.host/index.php/`}</inlineCode>{`,`}<br />{` the web service is `}<inlineCode parentName=\"td\">{`rest`}</inlineCode>{`.`}<br />{` and the resource is `}<inlineCode parentName=\"td\">{`/V1/integration/customer/token`}</inlineCode>{`.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Content type`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The content type of the request body. Set this value to either `}<inlineCode parentName=\"td\">{`\"Content-Type:application/json\"`}</inlineCode>{` or `}<inlineCode parentName=\"td\">{`\"Content-Type:application/xml\"`}</inlineCode>{`.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Credentials`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The username and password for a Commerce account.`}<br /><br />{`To specify these credentials in a JSON request body, include code similar to the following in the call: `}<br /><br /><inlineCode parentName=\"td\">{`{\"username\":\"<USER-NAME>;\", \"password\":\"<PASSWORD>\"}`}</inlineCode><br /><br />{`To specify these credentials in XML, include code similar to the following in the call:`}<br /><br /><inlineCode parentName=\"td\">{`<login><username>customer1</username><password>customer1pw</password></login>`}</inlineCode></td>\n        </tr>\n      </tbody>\n    </table>\n    <h3 {...{\n      \"id\": \"examples\"\n    }}>{`Examples`}</h3>\n    <p>{`The following image shows a token request for the admin account using a REST client:`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"53.125%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/5530d/gs_auth_token1.webp 320w\", \"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/0c8fb/gs_auth_token1.webp 640w\", \"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/94b1e/gs_auth_token1.webp 1280w\", \"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/0b34d/gs_auth_token1.webp 1920w\", \"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/63696/gs_auth_token1.webp 1948w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/dd4a7/gs_auth_token1.png 320w\", \"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/0f09e/gs_auth_token1.png 640w\", \"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/bbbf7/gs_auth_token1.png 1280w\", \"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/ac7a9/gs_auth_token1.png 1920w\", \"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/46dcf/gs_auth_token1.png 1948w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/commerce-webapi/static/ae799da73e18e3727f6db2cf6d2d95d9/bbbf7/gs_auth_token1.png\",\n            \"alt\": \"REST client\",\n            \"title\": \"REST client\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`The following example uses the `}<inlineCode parentName=\"p\">{`curl`}</inlineCode>{` command to request a token for a customer account:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`curl -X POST \"https://<host>/rest/default/V1/integration/customer/token\" \\\\\n     -H \"Content-Type:application/json\" \\\\\n     -d '{\"username\":\"customer@example.com\", \"password\":\"customer_password\"}'\n`}</code></pre>\n    <p>{`The following example makes the same request with XML for a customer account token:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`curl -X POST \"http://<host>/rest/default/V1/integration/customer/token\" \\\\\n     -H \"Content-Type:application/xml\"  \\\\\n     -d \"<login><username>customer1</username><password>customer1pw</password></login>\"\n`}</code></pre>\n    <p>{`For more information about the `}<inlineCode parentName=\"p\">{`curl`}</inlineCode>{` command, see `}<a parentName=\"p\" {...{\n        \"href\": \"../gs-curl.md\"\n      }}>{`Use cURL to run the request`}</a></p>\n    <h2 {...{\n      \"id\": \"authentication-token-response\"\n    }}>{`Authentication token response`}</h2>\n    <p>{`A successful request returns a response body with the token, as follows:`}</p>\n    <p><inlineCode parentName=\"p\">{`asdf3hjklp5iuytre`}</inlineCode></p>\n    <h2 {...{\n      \"id\": \"use-the-token-in-a-web-api-request\"\n    }}>{`Use the token in a Web API request`}</h2>\n    <p>{`Any web API call that accesses a resource that requires a permission level higher than anonymous must contain the authentication token in the header To do this, specify a HTTP header in the following format:`}</p>\n    <p><inlineCode parentName=\"p\">{`Authorization: Bearer <authentication token>`}</inlineCode></p>\n    <h3 {...{\n      \"id\": \"admin-access\"\n    }}>{`Admin access`}</h3>\n    <p>{`Admins can access any resources for which they are authorized.`}</p>\n    <p>{`For example, to make a web API call with an admin token:`}</p>\n    <p><inlineCode parentName=\"p\">{`curl -X GET \"http://<host>/rest/default/V1/customers/2\" -H \"Authorization: Bearer vbnf3hjklp5iuytre\"`}</inlineCode></p>\n    <h3 {...{\n      \"id\": \"customer-access\"\n    }}>{`Customer access`}</h3>\n    <p>{`Customers can access only resources with `}<inlineCode parentName=\"p\">{`self`}</inlineCode>{` permissions.`}</p>\n    <p>{`For example, to make a web API call with a customer token:\n`}<inlineCode parentName=\"p\">{`curl -X GET \"http://<host>/rest/default/V1/customers/me\" -H \"Authorization: Bearer asdf3hjklp5iuytre\"`}</inlineCode></p>\n    <h4 {...{\n      \"id\": \"related-topics\"\n    }}>{`Related topics`}</h4>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"../gs-web-api-request.md\"\n      }}>{`Construct a request`}</a></p>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://developer.adobe.com/commerce/php/development/components/web-api/services/\"\n      }}>{`Configure services as web APIs`}</a></p>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://developer.adobe.com/commerce/webapi/rest/use-rest/anonymous-api-security/\"\n      }}>{`Restricting access to anonymous web APIs`}</a></p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"sourceRoot":""}