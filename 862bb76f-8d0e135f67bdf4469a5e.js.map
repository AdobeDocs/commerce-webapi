{"version":3,"file":"862bb76f-8d0e135f67bdf4469a5e.js","mappings":"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","sources":["webpack://commerce-webapi/./node_modules/@adobe/gatsby-theme-aio/src/components/GetCredential/MyCredential.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { css } from '@emotion/react';\r\nimport classNames from 'classnames';\r\nimport JSZip from 'jszip';\r\nimport JSZipUtils from 'jszip-utils';\r\nimport { saveAs } from 'file-saver';\r\nimport { MAX_TABLET_SCREEN_WIDTH, MIN_MOBILE_WIDTH } from './FormFields';\r\nimport { Toast } from '../Toast';\r\nimport { CardProducts } from './Products';\r\nimport { SideComponent } from './SideComponent';\r\nimport { AccessToken } from './Card/AccessToken';\r\nimport { DevConsoleLink } from './Card/DevConsoleLink';\r\nimport { CardClientDetails } from './Card/CardClientDetails';\r\nimport { SideContent } from './Form/SideContent';\r\nimport GetCredentialContext from './GetCredentialContext';\r\nimport { CredentialDetailsCard } from './CredentialDetailsCard';\r\n\r\nconst MyCredential = ({\r\n  formData,\r\n  response,\r\n  handleRestart\r\n}) => {\r\n  const { getCredentialData, selectedOrganization: organizationName } = useContext(GetCredentialContext);\r\n  const credentialProps = getCredentialData;\r\n\r\n  const [isDownloadStart, setIsDownloadStart] = useState();\r\n  const [isCopiedTooltip, setCopiedTooltip] = useState('');\r\n\r\n  const myCredentialFields = {};\r\n  const productsObj = { label: 'products', productList: [] };\r\n\r\n  credentialProps?.[MyCredential]?.children.forEach(({ type, props }) => {\r\n    myCredentialFields[type] = props;\r\n    if (props.children && type === CardClientDetails) {\r\n      myCredentialFields[type] = props;\r\n      props?.children?.forEach(({ type, props }) => {\r\n        myCredentialFields[type] = props;\r\n      });\r\n    }\r\n    if (type === CardProducts && props?.children) {\r\n      productsObj.productList.push(\r\n        ...[].concat(props.children).map(({ props: { label, icon } }) => ({ label, icon }))\r\n      );\r\n    }\r\n  });\r\n  const product = productsObj?.productList;\r\n\r\n  useEffect(() => {\r\n    if (formData['Downloads']) {\r\n      downloadZIP(\r\n        `/console/api/organizations/${organizationName?.id}/projects/${response.projectId}/workspaces/${response.workspaceId}/download`,\r\n        formData['Download'],\r\n        formData['zipUrl']\r\n      );\r\n    }\r\n  }, []);\r\n\r\n  const card = credentialProps?.[MyCredential];\r\n\r\n  const downloadZIP = async (downloadAPI, fileName = 'download', zipFileURL) => {\r\n    setIsDownloadStart(true);\r\n    try {\r\n      const zipData = await JSZipUtils.getBinaryContent(zipFileURL);\r\n      const zipArrayBuffer = new Uint8Array(zipData).buffer;\r\n      const zip = new JSZip();\r\n\r\n      await zip.loadAsync(zipArrayBuffer);\r\n\r\n      const token = window.adobeIMS?.getTokenFromStorage()?.token;\r\n      const options = {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: 'Bearer ' + token,\r\n          'x-api-key': window?.adobeIMS?.adobeIdData?.client_id,\r\n        },\r\n      };\r\n\r\n      const response = await fetch(downloadAPI, options);\r\n\r\n      if (response.status === 200) {\r\n        const credential = await response.json();\r\n\r\n        zip.file('credential.json', JSON.stringify(credential));\r\n\r\n        const modifiedZipBlob = await zip.generateAsync({ type: 'blob' });\r\n        saveAs(modifiedZipBlob, `${fileName}.zip`);\r\n      } else {\r\n        console.error('Failed to fetch additional data. Response status:', response.status);\r\n      }\r\n    } catch (error) {\r\n      console.error('An error occurred:', error);\r\n    } finally {\r\n      setIsDownloadStart(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={classNames(card?.className)}\r\n      css={css`\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 48px;\r\n      `}>\r\n      <div\r\n        className={classNames(card?.className)}\r\n        css={css`\r\n          display: flex;\r\n          flex-direction: column;\r\n          gap: 16px;\r\n          color: var(--spectrum-global-color-gray-800);\r\n          width: 100%;\r\n          height: 100%;\r\n          text-align: left;\r\n\r\n          @media screen and (min-width: ${MIN_MOBILE_WIDTH}) and (max-width: ${MAX_TABLET_SCREEN_WIDTH}) {\r\n            padding: 0;\r\n            width: 100%;\r\n          }\r\n        `}>\r\n        <div\r\n          css={css`\r\n            display: flex;\r\n            gap: 20px;\r\n            align-items: baseline;\r\n          `}>\r\n          {card?.title && (\r\n            <h2\r\n              className=\"spectrum-Heading spectrum-Heading--sizeL\"\r\n              css={css`\r\n                font-weight: 700;\r\n                color: var(--spectrum-global-color-gray-900);\r\n              `}>\r\n              {card?.title}\r\n            </h2>\r\n          )}\r\n          {isDownloadStart && (\r\n            <div\r\n              css={css`\r\n                display: flex;\r\n                text-align: center;\r\n                align-items: center;\r\n                gap: 10px;\r\n              `}>\r\n              <div className=\"spectrum-ProgressCircle spectrum-ProgressCircle--indeterminate spectrum-ProgressCircle--small\">\r\n                <div className=\"spectrum-ProgressCircle-track\"></div>\r\n                <div className=\"spectrum-ProgressCircle-fills\">\r\n                  <div className=\"spectrum-ProgressCircle-fillMask1\">\r\n                    <div className=\"spectrum-ProgressCircle-fillSubMask1\">\r\n                      <div className=\"spectrum-ProgressCircle-fill\"></div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"spectrum-ProgressCircle-fillMask2\">\r\n                    <div className=\"spectrum-ProgressCircle-fillSubMask2\">\r\n                      <div className=\"spectrum-ProgressCircle-fill\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <p\r\n                css={css`\r\n                  margin: 0;\r\n                `}>\r\n                Downloading...\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n        {formData['Downloads'] && card?.paragraph && (\r\n          <p\r\n            className=\"spectrum-Body spectrum-Body--sizeL\"\r\n            css={css`\r\n              color: var(--spectrum-global-color-gray-900);\r\n            `}>\r\n            {card?.paragraph}\r\n          </p>\r\n        )}\r\n        {formData['Downloads'] && (\r\n          <p\r\n            className=\"spectrum-Body spectrum-Body--sizeS\"\r\n            css={css`\r\n              color: var(--spectrum-global-color-gray-900);\r\n            `}>\r\n            Download not working?\r\n            <button\r\n              css={css`\r\n                padding: 0;\r\n                font-family: 'adobe-clean';\r\n                border: none;\r\n                background: transparent;\r\n                margin-left: 10px;\r\n                cursor: pointer;\r\n                text-decoration: underline;\r\n                color: rgb(0, 84, 182);\r\n                &:hover {\r\n                  color: rgb(2, 101, 220);\r\n                }\r\n              `}\r\n              onClick={() =>\r\n                downloadZIP(\r\n                  `/console/api/organizations/${organizationName?.id}/projects/${response.projectId}/workspaces/${response.workspaceId}/download`,\r\n                  formData['Download'],\r\n                  formData['zipUrl']\r\n                )\r\n              }\r\n              data-cy=\"restart-download\">\r\n              Restart download\r\n            </button>\r\n          </p>\r\n        )}\r\n      </div>\r\n      <div\r\n        css={css`\r\n          display: flex;\r\n          gap: 35px;\r\n\r\n          @media screen and (min-width: ${MIN_MOBILE_WIDTH}) and (max-width: ${MAX_TABLET_SCREEN_WIDTH}) {\r\n            flex-direction: column;\r\n            padding-left: 0;\r\n          }\r\n        `}>\r\n        <div\r\n          css={css`\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: 35px;\r\n            width: 50%;\r\n\r\n            @media screen and (min-width: ${MIN_MOBILE_WIDTH}) and (max-width: ${MAX_TABLET_SCREEN_WIDTH}) {\r\n              width: 100%;\r\n            }\r\n          `}>\r\n          <CredentialDetailsCard\r\n            credentialName={formData['CredentialName']}\r\n            productList={product}\r\n            ProductComponent={CardProducts}\r\n            AccessTokenComponent={AccessToken}\r\n            DevConsoleLinkComponent={DevConsoleLink}\r\n            ClientDetailsComponent={CardClientDetails}\r\n            allowedOriginsDetails={formData['AllowedOrigins']}\r\n            organizationName={organizationName}\r\n            response={response}\r\n            nextButtonLink={card?.nextStepsHref}\r\n            nextButtonLabel={card?.nextStepsLabel}\r\n            devConsoleLink={card?.devConsoleDirection}\r\n            developerConsoleManage={card?.developerConsoleManage}\r\n            myCredentialFields={myCredentialFields}\r\n          />\r\n          <div\r\n            css={css`\r\n              display: flex;\r\n              flex-direction: column;\r\n              gap: 8px;\r\n              width: 80%;\r\n            `}>\r\n            <h4\r\n              className=\"spectrum-Heading spectrum-Heading--sizeXS\"\r\n              css={css`\r\n                font-weight: 700;\r\n                color: var(--spectrum-global-color-gray-900);\r\n              `}>\r\n              Need another credential\r\n            </h4>\r\n            <p className=\"spectrum-Body spectrum-Body--sizeS\">\r\n              <button\r\n                onClick={handleRestart}\r\n                css={css`\r\n                  border: none;\r\n                  padding: 0;\r\n                  font-family: 'adobe-clean';\r\n                  background: transparent;\r\n                  color: var(--spectrum-global-color-gray-800);\r\n                  text-decoration: underline;\r\n                  cursor: pointer;\r\n                  &:hover {\r\n                    color: var(--spectrum-global-color-gray-900);\r\n                  }\r\n                `} data-cy=\"Restart-new-credential\">\r\n                Restart and create a new credential\r\n              </button>\r\n            </p>\r\n          </div>\r\n        </div>\r\n        {card?.children ? (\r\n          <SideContent\r\n            sideContent={myCredentialFields[SideComponent]?.children}\r\n            SideComp={SideComponent}\r\n          />\r\n        ) : null}\r\n      </div>\r\n      {isCopiedTooltip && (\r\n        <Toast\r\n          variant=\"success\"\r\n          message=\"Copied to clipboard\"\r\n          disable={1000}\r\n          customDisableFunction={setCopiedTooltip}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport { MyCredential };\r\n"],"names":["MyCredential","formData","response","handleRestart","getCredentialData","selectedOrganization","organizationName","useContext","GetCredentialContext","credentialProps","isDownloadStart","setIsDownloadStart","useState","isCopiedTooltip","setCopiedTooltip","myCredentialFields","productsObj","label","productList","children","forEach","type","props","CardClientDetails","CardProducts","push","concat","map","icon","product","useEffect","downloadZIP","id","projectId","workspaceId","card","async","downloadAPI","fileName","zipFileURL","zipData","JSZipUtils","zipArrayBuffer","Uint8Array","buffer","zip","JSZip","loadAsync","options","method","headers","Authorization","window","adobeIMS","getTokenFromStorage","token","adobeIdData","client_id","fetch","status","credential","json","file","JSON","stringify","modifiedZipBlob","generateAsync","saveAs","console","error","className","classNames","css","MIN_MOBILE_WIDTH","MAX_TABLET_SCREEN_WIDTH","title","paragraph","onClick","credentialName","ProductComponent","AccessTokenComponent","AccessToken","DevConsoleLinkComponent","DevConsoleLink","ClientDetailsComponent","allowedOriginsDetails","nextButtonLink","nextStepsHref","nextButtonLabel","nextStepsLabel","devConsoleLink","devConsoleDirection","developerConsoleManage","sideContent","SideComponent","SideComp","variant","message","disable","customDisableFunction"],"sourceRoot":""}