"use strict";(self.webpackChunkcommerce_webapi=self.webpackChunkcommerce_webapi||[]).push([[6758],{60729:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return l},default:function(){return s}});var n=a(87462),m=a(63366),r=(a(15007),a(64983)),d=a(91515),o=["components"],l={},i={_frontmatter:l},p=d.Z;function s(e){var t=e.components,a=(0,m.Z)(e,o);return(0,r.mdx)(p,(0,n.Z)({},i,a,{components:t,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"braintree-vault-payment-method"},"Braintree Vault payment method"),(0,r.mdx)("p",null,"Braintree Vault is a payment gateway that processes debit and credit card payments from the Magento_Vault."),(0,r.mdx)("h2",{id:"braintree-vault-workflow"},"Braintree Vault workflow"),(0,r.mdx)("p",null,"The following diagram shows the workflow for placing an order when Braintree Vault is the selected payment method."),(0,r.mdx)("p",null,(0,r.mdx)("img",{parentName:"p",src:"/commerce-webapi/assets/d12a3f4ee2db6181b2fd6372e1f8afd1/braintree-vault.svg",alt:"Braintree sequence diagram"})),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"Use the ",(0,r.mdx)("a",{parentName:"p",href:"../schema/checkout/queries/customer-payment-tokens.md"},(0,r.mdx)("inlineCode",{parentName:"a"},"customerPaymentTokens"))," query to retrieve\nthe payment tokens the customer has stored in the vault.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"The application returns an array of payment tokens.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"The client renders the token information, and the customer selects a payment method."),(0,r.mdx)("p",{parentName:"li"},"When the customer selects a stored payment method, the PWA uses the ",(0,r.mdx)("a",{parentName:"p",href:"../schema/cart/mutations/set-payment-method.md"},(0,r.mdx)("inlineCode",{parentName:"a"},"setPaymentMethodOnCart"))," mutation to set the payment method to ",(0,r.mdx)("a",{parentName:"p",href:"#braintree_cc_vault-object"},(0,r.mdx)("inlineCode",{parentName:"a"},"braintree_cc_vault")),". The vaulted public hash is passed with other optional properties in the ",(0,r.mdx)("inlineCode",{parentName:"p"},"braintree_cc_vault"),".")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"The application returns a ",(0,r.mdx)("inlineCode",{parentName:"p"},"Cart")," object.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"The client runs the ",(0,r.mdx)("a",{parentName:"p",href:"../schema/cart/mutations/place-order.md"},(0,r.mdx)("inlineCode",{parentName:"a"},"placeOrder"))," mutation.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"The application sends an authorization request to the gateway.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"The gateway sends the response to Magento.")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("p",{parentName:"li"},"The application creates an order and sends an order ID in response to the ",(0,r.mdx)("inlineCode",{parentName:"p"},"placeOrder")," mutation."))),(0,r.mdx)("h2",{id:"setpaymentmethodoncart-mutation"},(0,r.mdx)("inlineCode",{parentName:"h2"},"setPaymentMethodOnCart")," mutation"),(0,r.mdx)("p",null,"When you set the payment method to Braintree in the ",(0,r.mdx)("a",{parentName:"p",href:"../schema/cart/mutations/set-payment-method.md"},(0,r.mdx)("inlineCode",{parentName:"a"},"setPaymentMethodOnCart")),"\nmutation, the ",(0,r.mdx)("inlineCode",{parentName:"p"},"payment_method")," object must contain a ",(0,r.mdx)("a",{parentName:"p",href:"#braintree_cc_vault-object"},(0,r.mdx)("inlineCode",{parentName:"a"},"braintree_cc_vault"))," object."),(0,r.mdx)("h3",{id:"braintree_cc_vault-object"},"braintree_cc_vault object"),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"braintree_cc_vault")," object must contain the following attributes:"),(0,r.mdx)("table",null,(0,r.mdx)("thead",{parentName:"table"},(0,r.mdx)("tr",{parentName:"thead"},(0,r.mdx)("th",{parentName:"tr",align:null},"Attribute"),(0,r.mdx)("th",{parentName:"tr",align:null},"Data Type"),(0,r.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,r.mdx)("tbody",{parentName:"table"},(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},(0,r.mdx)("inlineCode",{parentName:"td"},"public_hash")),(0,r.mdx)("td",{parentName:"tr",align:null},"String!"),(0,r.mdx)("td",{parentName:"tr",align:null},"Required input for Magento_Vault public hash for the selected stored payment method")),(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},(0,r.mdx)("inlineCode",{parentName:"td"},"device_data")),(0,r.mdx)("td",{parentName:"tr",align:null},"String"),(0,r.mdx)("td",{parentName:"tr",align:null},"Optional. JSON-encoded device data for Kount integration")))),(0,r.mdx)("h3",{id:"example-usage"},"Example Usage"),(0,r.mdx)("p",null,"The following example shows the ",(0,r.mdx)("inlineCode",{parentName:"p"},"setPaymentMethodOnCart")," mutation constructed for the Braintree Vault payment method."),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Request:")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-graphql"},'mutation {\n  setPaymentMethodOnCart(\n    input: {\n      cart_id: "IeTUiU0oCXjm0uRqGCOuhQ2AuQatogjG"\n      payment_method: {\n        code: "braintree_cc_vault"\n        braintree_cc_vault: { public_hash: "fake-public-hash" }\n      }\n    }\n  ) {\n    cart {\n      selected_payment_method {\n        code\n        title\n      }\n    }\n  }\n}\n')),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Response:")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "setPaymentMethodOnCart": {\n      "cart": {\n        "selected_payment_method": {\n          "code": "braintree_cc_vault"\n          "title": "Stored Cards"\n        }\n      }\n    }\n  }\n}\n')))}s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-graphql-payment-methods-braintree-vault-md-f561c3a5e9250efa8804.js.map