{"version":3,"file":"component---src-pages-graphql-payment-methods-klarna-md-29c91271f6e3c95ff9b2.js","mappings":"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","sources":["webpack://commerce-webapi/./src/pages/graphql/payment-methods/klarna.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/commerce-webapi/commerce-webapi/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"klarna-payment-method\"\n    }}>{`Klarna payment method`}</h1>\n    <p>{`Klarna Payments enables your consumers to try before they buy, finance purchases on your store with Klarna, or let them pay directly. Klarna offers these payment methods through a widget that you can add inline on your checkout page.`}</p>\n    <h2 {...{\n      \"id\": \"klarna-payments-workflow\"\n    }}>{`Klarna payments workflow`}</h2>\n    <p>{`The following diagram shows the workflow for placing an order when Klarna is the selected payment method.`}</p>\n    <p>{`Klarna payments require cart information to initiate the session. For this reason, the following steps can be executed only after a cart has been created.`}</p>\n    <p><img parentName=\"p\" {...{\n        \"src\": \"/commerce-webapi/assets/99004e2b243d4724d967190eec282221/klarna-payments.svg\",\n        \"alt\": \"Klarna payments sequence diagram\"\n      }}></img></p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The PWA client calls the `}<a parentName=\"p\" {...{\n            \"href\": \"../schema/checkout/mutations/create-klarna-payments-session.md\"\n          }}><inlineCode parentName=\"a\">{`createKlarnaPaymentsSession`}</inlineCode></a>{` mutation to generate the `}<inlineCode parentName=\"p\">{`client_token`}</inlineCode>{` and retrieve a list of `}<inlineCode parentName=\"p\">{`payment_categories`}</inlineCode>{`.`}</p>\n        <p parentName=\"li\">{`This step can be executed at any time after the cart is created. However, we recommend that you add products to the cart and set the billing address, shipping address, and shipping method on the cart before you perform this step.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application forwards the request to Klarna.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Klarna returns the `}<inlineCode parentName=\"p\">{`client_token`}</inlineCode>{` and the `}<inlineCode parentName=\"p\">{`payment_categories`}</inlineCode>{` available to the shopper.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application forwards the token to the client.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The client sends the `}<inlineCode parentName=\"p\">{`cart`}</inlineCode>{` query to retrieve the available payment methods.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application must always retrieve the latest status information from Klarna before returning the Klarna payments method as an option to the shopper. This is important to ensure that the shopper is always shown the latest available payment options.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Klarna returns an updated list of `}<inlineCode parentName=\"p\">{`payment_categories`}</inlineCode>{`.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application returns all available payment methods, including Klarna payment methods.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The PWA client renders the Klarna payment widget.`}</p>\n        <p parentName=\"li\">{`The PWA client uses the `}<inlineCode parentName=\"p\">{`client_token`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`payment_categories`}</inlineCode>{` to initialize the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.klarna.com/documentation/klarna-payments/javascript-sdk/\"\n          }}>{`Klarna Payments JS SDK`}</a>{`.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The PWA client sends the `}<a parentName=\"p\" {...{\n            \"href\": \"https://developers.klarna.com/documentation/klarna-payments/single-call-descriptions/authorize-the-purchase/\"\n          }}>{`authorization`}</a>{` directly to Klarna.`}</p>\n        <p parentName=\"li\">{`On the checkout page, the shopper selects Klarna as the payment method and clicks `}<strong parentName=\"p\">{`Place Order`}</strong>{`. When this happens, the PWA client must send the `}<inlineCode parentName=\"p\">{`authorize()`}</inlineCode>{` call to Klarna. Then the shopper follows the authorization steps on the Klarna inline modal. During this phase, the communication between the PWA client and Klarna is handled directly by the Klarna Payments JS SDK.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Klarna returns the `}<inlineCode parentName=\"p\">{`authorization_token`}</inlineCode>{` in response to the authorize call.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Set the Payment Method providing the `}<inlineCode parentName=\"p\">{`authorization_token`}</inlineCode>{` as part of the `}<inlineCode parentName=\"p\">{`setPaymentMethodOnCart`}</inlineCode>{` mutation.`}</p>\n        <p parentName=\"li\">{`The client uses the `}<a parentName=\"p\" {...{\n            \"href\": \"../schema/cart/mutations/set-payment-method.md\"\n          }}><inlineCode parentName=\"a\">{`setPaymentMethodOnCart`}</inlineCode></a>{` mutation to set the payment method to `}<inlineCode parentName=\"p\">{`klarna_<identifier-value>`}</inlineCode>{`. The `}<inlineCode parentName=\"p\">{`authorization_token`}</inlineCode>{` is passed in the `}<inlineCode parentName=\"p\">{`klarna`}</inlineCode>{` object.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application returns an updated `}<inlineCode parentName=\"p\">{`cart`}</inlineCode>{` object.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The PWA client runs the `}<inlineCode parentName=\"p\">{`placeOrder`}</inlineCode>{` mutation.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application sends the place order request to Klarna.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Klarna sends the response to Magento.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application creates an order and sends an order ID in response to the `}<inlineCode parentName=\"p\">{`placeOrder`}</inlineCode>{` mutation.`}</p>\n      </li>\n    </ol>\n    <h2 {...{\n      \"id\": \"how-to-handle-cart-updates\"\n    }}>{`How to handle cart updates`}</h2>\n    <p>{`During the purchase flow, the cart can be updated by adding additional products, applying coupons, and changing the billing or shipping address. All these events might cause a change in Klarna options for the specific shopper.`}</p>\n    <p>{`In order to always present shoppers with the latest available payment options provided by Klarna, the PWA client must:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Perform a cart update.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application returns an updated `}<inlineCode parentName=\"p\">{`cart`}</inlineCode>{` object.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Send the `}<inlineCode parentName=\"p\">{`cart`}</inlineCode>{` query to retrieve the latest available payment methods.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application sends another request to Klarna with the latest information available from the cart.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Klarna returns new list of payment methods. Note that the list might contain different options for the shopper.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The application returns an updated `}<inlineCode parentName=\"p\">{`cart`}</inlineCode>{` object.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\"><a parentName=\"p\" {...{\n            \"href\": \"https://developers.klarna.com/documentation/klarna-payments/single-call-descriptions/load-klarna-payments/\"\n          }}>{`Reload the widget`}</a>{` on the client side.`}</p>\n      </li>\n    </ol>\n    <p>{`The following diagram describes the workflow:`}</p>\n    <p><img parentName=\"p\" {...{\n        \"src\": \"/commerce-webapi/assets/6f17184f43a03339daea54e50935bc68/klarna-payments-cart-updates.svg\",\n        \"alt\": \"Klarna payments cart updates sequence diagram\"\n      }}></img></p>\n    <h2 {...{\n      \"id\": \"setpaymentmethodoncart-mutation\"\n    }}>{`setPaymentMethodOnCart mutation`}</h2>\n    <p>{`When you set the payment method to Klarna in the `}<a parentName=\"p\" {...{\n        \"href\": \"../schema/cart/mutations/set-payment-method.md\"\n      }}><inlineCode parentName=\"a\">{`setPaymentMethodOnCart`}</inlineCode></a>{` mutation, the `}<inlineCode parentName=\"p\">{`payment_method`}</inlineCode>{` object must contain a `}<inlineCode parentName=\"p\">{`klarna`}</inlineCode>{` object.`}</p>\n    <h3 {...{\n      \"id\": \"klarna-object\"\n    }}>{`klarna object`}</h3>\n    <p>{`The `}<inlineCode parentName=\"p\">{`klarna`}</inlineCode>{` object must contain the following attributes:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Attribute`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Data Type`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`authorization_token`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`String!`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The one-time authorization token generated by the Klarna payment gateway based on shopper details collected during the purchase flow`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <h2 {...{\n      \"id\": \"example-usage\"\n    }}>{`Example usage`}</h2>\n    <p>{`The following example shows the  `}<inlineCode parentName=\"p\">{`setPaymentMethodOnCart`}</inlineCode>{` mutation constructed for the Klarna payment method.`}</p>\n    <p><strong parentName=\"p\">{`Request:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`mutation {\n  setPaymentMethodOnCart(input: {\n    cart_id: \"3WxC8gQn4Fbo55yqVLSiUFJ9fmEwnlxG\"\n    payment_method: {\n      code: \"klarna_pay_later\"\n      klarna: {\n        authorization_token: \"e9abc610-6748-256f-a506-355626551326\"\n      }\n    }\n  }) {\n  cart {\n    selected_payment_method {\n      code\n    }\n  }\n}\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Response:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"data\": {\n    \"setPaymentMethodOnCart\": {\n     \"cart\": {\n       \"selected_payment_method\": {\n         \"code\": \"klarna_pay_later\"\n        }\n      }\n    }\n  }\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"sourceRoot":""}