"use strict";(self.webpackChunkcommerce_webapi=self.webpackChunkcommerce_webapi||[]).push([[8247],{62393:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return m},default:function(){return x}});var a=n(87462),r=n(45987),d=(n(35776),n(3905)),o=n(91515),s=n(8673);const l=["components"],m={},u=(i="InlineAlert",function(e){return console.warn("Component "+i+" was not imported, exported, or provided by MDXProvider as global scope"),(0,d.mdx)("div",e)});var i;const p={_frontmatter:m},c=o.Z;function x(e){let{components:t}=e,n=(0,r.Z)(e,l);return(0,d.mdx)(c,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,d.mdx)("h1",{id:"asynchronous-web-endpoints"},"Asynchronous web endpoints"),(0,d.mdx)("p",null,"An asynchronous web endpoint intercepts messages to a Web API and writes them to the message queue. Each time the system accepts such an API request, it generates a UUID identifier. Adobe Commerce includes this UUID when it adds the message to the queue. Then, a consumer reads the messages from the queue and executes them one-by-one."),(0,d.mdx)(u,{variant:"success",slots:"text",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"Use the ",(0,d.mdx)("inlineCode",{parentName:"p"},"bin/magento queue:consumers:start async.operations.all")," command to start the consumer that handles asynchronous and bulk API messages."),(0,d.mdx)("p",null,"Commerce supports the following types of asynchronous requests:"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},"POST"),(0,d.mdx)("li",{parentName:"ul"},"PUT"),(0,d.mdx)("li",{parentName:"ul"},"DELETE"),(0,d.mdx)("li",{parentName:"ul"},"PATCH")),(0,d.mdx)(u,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"GET requests are not supported. Although Commerce does not currently implement any PATCH requests, they are supported in custom extensions."),(0,d.mdx)("p",null,"The route to all asynchronous calls contains the prefix ",(0,d.mdx)("inlineCode",{parentName:"p"},"/async"),", added before ",(0,d.mdx)("inlineCode",{parentName:"p"},"/V1")," of a standard synchronous endpoint. For example:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-http"},"POST /async/V1/products\nPUT /async/V1/products/:sku\n")),(0,d.mdx)(s.sitedatavarce,null)," and ",(0,d.mdx)(s.sitedatavaree,null)," installations support asynchronous web endpoints.",(0,d.mdx)("p",null,"The ",(0,d.mdx)("a",{parentName:"p",href:"/commerce-webapi/rest/"},"REST API documentation")," provides a list of all current synchronous Commerce API routes."),(0,d.mdx)("p",null,"The response of an asynchronous request contains the following fields:"),(0,d.mdx)("table",null,(0,d.mdx)("thead",{parentName:"table"},(0,d.mdx)("tr",{parentName:"thead"},(0,d.mdx)("th",{parentName:"tr",align:null},"Field name"),(0,d.mdx)("th",{parentName:"tr",align:null},"Data type"),(0,d.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,d.mdx)("tbody",{parentName:"table"},(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"bulk_uuid")),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"A generated universally unique identifier.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"request_items")),(0,d.mdx)("td",{parentName:"tr",align:null},"Object"),(0,d.mdx)("td",{parentName:"tr",align:null},"An array containing information about the status of the asynchronous request.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"id")),(0,d.mdx)("td",{parentName:"tr",align:null},"Integer"),(0,d.mdx)("td",{parentName:"tr",align:null},"A generated ID that identifies the request.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"data_hash")),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"SHA256 encoded content of incoming message.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"status")),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"Reserved for future use. Currently, the value is always ",(0,d.mdx)("inlineCode",{parentName:"td"},"accepted"),".")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"errors")),(0,d.mdx)("td",{parentName:"tr",align:null},"Boolean"),(0,d.mdx)("td",{parentName:"tr",align:null},"Reserved for future use. Currently, the value is always ",(0,d.mdx)("inlineCode",{parentName:"td"},"false"),". If an error occurs, the system provides all error-related information as a standard ",(0,d.mdx)("inlineCode",{parentName:"td"},"webapi")," exception.")))),(0,d.mdx)("h2",{id:"sample-usage"},"Sample usage"),(0,d.mdx)("p",null,"The following call asynchronously changes the price of the product that has a ",(0,d.mdx)("inlineCode",{parentName:"p"},"sku")," of ",(0,d.mdx)("inlineCode",{parentName:"p"},"24-MB01"),":"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-http"},"PUT <host>/rest/<store_code>/async/V1/products/24-MB01\n")),(0,d.mdx)("h3",{id:"payload"},"Payload"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "product": {\n    "price": 29\n  }\n}\n')),(0,d.mdx)("h3",{id:"response"},"Response"),(0,d.mdx)("p",null,"Commerce generates a ",(0,d.mdx)("inlineCode",{parentName:"p"},"bulk_uuid")," for each asynchronous request. Use the ",(0,d.mdx)("inlineCode",{parentName:"p"},"bulk_uuid")," to determine the ",(0,d.mdx)("a",{parentName:"p",href:"/commerce-webapi/rest/use-rest/operation-status-endpoints/"},"operation status")," of your request."),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "bulk_uuid": "fbfca270-7a90-4c4e-9f32-d6cf3728cdc7",\n    "request_items": [\n        {\n            "id": 0,\n            "data_hash": "9c1bd4bfd8defcc856ddf129cc01d172625d139d5f7dcf53b6cb09a0e9a843a3",\n            "status": "accepted"\n        }\n    ],\n    "errors": false\n}\n')),(0,d.mdx)("h2",{id:"store-scopes"},"Store scopes"),(0,d.mdx)("p",null,"You can specify a store code (which is labeled in the Admin as store view code) in the route of an asynchronous endpoint so that it operates on a specific store, as shown below:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-http"},"POST /<store_code>/async/V1/products\nPUT /<store_code>/async/V1/products/:sku\n")),(0,d.mdx)("p",null,"As a result, the asynchronous calls update the products on the specific store, instead of the default store."),(0,d.mdx)("p",null,"You can specify the ",(0,d.mdx)("inlineCode",{parentName:"p"},"all")," store code to perform operations on all existing stores:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-http"},"POST /all/async/V1/products\nPUT /all/async/V1/products/:sku\n")),(0,d.mdx)("h3",{id:"fallback-and-creatingupdating-objects-when-setting-store-scopes"},"Fallback and creating/updating objects when setting store scopes"),(0,d.mdx)("p",null,"The following rules apply when you create or update an object, such as a product."),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},"If you do not set the store code while creating a new product, Commerce creates a new object with all values set globally for each scope."),(0,d.mdx)("li",{parentName:"ul"},"If you do not set the store code while updating a product, then by fallback, Commerce updates values for the default store only."),(0,d.mdx)("li",{parentName:"ul"},"If you include the ",(0,d.mdx)("inlineCode",{parentName:"li"},"all")," parameter, then Commerce updates values for all store scopes (in case a particular store doesn't yet have its own value set)."),(0,d.mdx)("li",{parentName:"ul"},"If ",(0,d.mdx)("inlineCode",{parentName:"li"},"<store_code>")," parameter is set, then values for only defined store will be updated.")))}x.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-rest-use-rest-asynchronous-web-endpoints-md-a7f1a7c61fc518d63215.js.map