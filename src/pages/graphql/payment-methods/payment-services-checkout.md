---
title: Payment Services during a checkout authorization
description: Learn how Adobe Commerce uses GraphQL to process orders for the Payment Services payment method during a typical checkout authorization.
keywords:
  - GraphQL
  - Payments
---

# Payment services during a checkout authorization

[Payment Services for Adobe Commerce and Magento Open Source](https://experienceleague.adobe.com/docs/commerce-merchant-services/payment-services/guide-overview.html) is your turnkey self-service solution, including sandbox testing and a simple setup, for providing robust and secure payment processing for your Commerce websites.

These steps describe the flow of requests and responses required to complete a typical [checkout](../tutorials/checkout/index.md) authorization with Payment Services enabled.

## Checkout workflow

![Payment Services sequence diagram](../../_images/graphql/payment-services.svg)

1. Run `getPaymentConfig` to fetch the payment configuration to retrieve and render details about PayPal components, such as hosted fields, smart buttons, and Apple Pay.

1. Commerce returns payment configuration information.

1. Run `setPaymentMethodOnCart` to [set the payment method](../tutorials/checkout/set-payment-method.md).

1. Adobe Commerce returns a `Cart` object.

1. Run `createPaymentOrder` to begin the authorization process.

1. Commerce forwards the request to PayPal.

1. PayPal returns an `id` value.

1. Adobe Commerce generates a `order_id` and forwards the value in the `mp_order_id` field and the PayPal response in the `id` field.

1. (Optional) If hosted fields and the Signifyd integration are enabled, run `getPaymentOrder`.

1.  (Optional) Adobe Commerce returns details about the payment order.

1.  Run `placeOrder`.

1.  Commerce sends an authorization request to PayPal.

1.  PayPal returns the result to Commerce.

1.  Commerce creates an order.

## `setPaymentMethodOnCartInput` object

When you set the payment method to Payment Services in the [`setPaymentMethodOnCart`](../schema/cart/mutations/set-payment-method.md) mutation, the value of the `code` field can be one of the following:

* `payment_services_paypal_hosted_fields`
* `payment_services_paypal_smart_buttons`
* `payment_services_paypal_apple_pay`

### Payment Services object

The `Payment Services` object must contain the following attributes:

Attribute |  Data Type | Description
--- | --- | ---
`is_active_payment_token_enabler` | Boolean! | States whether a customer-entered credit/debit card should be tokenized for later usage. Required only if vaulting is enabled for Payment Services payment integration. The possible values are `True` or `False`
`location` | PaymentLocation! | The origin location for that payment request. The possible values are PRODUCT_DETAIL, MINICART, CART, CHECKOUT, ADMIN
`payments_order_id` | String! | The unique order ID generated in Commerce if Payment Services is enabled after PayPal returns the `paypal_order_id`
`paypal_order_id` | String! | The unique order ID generated by PayPal when receiving the authorization request
`payment_source` | String! | The identifiable payment source for the payment method

### `setPaymentMethodOnCart` mutation example

The following example shows the `setPaymentMethodOnCart` mutation constructed for the PayPal Hosted Fields payment method.

**Request:**

```text
mutation {
    setPaymentMethodOnCart ( input: {
      cart_id: "uocGxUi5H97XFAMhY3s66q4aFYG3Bmdr",
      payment_method: {
        code: "payment_services_paypal_hosted_fields",
        payment_services_paypal_hosted_fields: {
          payment_source: "cc",
          payments_order_id: "mp-order-a4babd34-13d3-4ac0-b1b0-109bb7be1574",
          paypal_order_id: "9R90936863877801D",
          is_active_payment_token_enabler: true,
          location: PRODUCT_DETAIL
        }
      }
    }
    ) {
       cart {
         id
         selected_payment_method {
           code
         }
       }
    }
  } 
```

**Response:**

```json
{
  "data": {
    "setPaymentMethodOnCart": {
      "cart": {
        "id": "r8TKHa58b7Y8VaZHLyABNxrEdS8hJJTZ",
        "selected_payment_method": {
          "code": "payment_services_paypal_hosted_fields"
        }
      }
    }
  }
}
```
