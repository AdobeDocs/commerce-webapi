"use strict";(self.webpackChunkcommerce_webapi=self.webpackChunkcommerce_webapi||[]).push([[9453],{62788:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return p},default:function(){return _}});var a,o=t(87462),i=t(63366),l=(t(15007),t(64983)),r=t(91515),s=["components"],p={},d=(a="InlineAlert",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,l.mdx)("div",e)}),m={_frontmatter:p},c=r.Z;function _(e){var n=e.components,t=(0,i.Z)(e,s);return(0,l.mdx)(c,(0,o.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,l.mdx)("h1",{id:"step-6-prepare-for-checkout"},"Step 6. Prepare for checkout"),(0,l.mdx)("p",null,"Now that all the items have been added to the cart, we can prepare the order for ",(0,l.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/checkout"},"checkout"),". This process includes the following steps:"),(0,l.mdx)("ul",null,(0,l.mdx)("li",{parentName:"ul"},"Estimate shipping costs"),(0,l.mdx)("li",{parentName:"ul"},"Set shipping and billing information")),(0,l.mdx)("h3",{id:"estimate-shipping-costs"},"Estimate shipping costs"),(0,l.mdx)("p",null,"Adobe Commerce calculates shipping costs for each shipping method that can be applied to the order. In this tutorial, the ",(0,l.mdx)("inlineCode",{parentName:"p"},"flatrate")," ($5 per item) and ",(0,l.mdx)("inlineCode",{parentName:"p"},"tablerate")," shipping methods are active."),(0,l.mdx)(d,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,l.mdx)("p",null,"Use the ",(0,l.mdx)("inlineCode",{parentName:"p"},"V1/guest-carts/<cartId>/estimate-shipping-methods")," endpoint to estimate shipping costs on behalf of a guest. Do not include an authorization token."),(0,l.mdx)("p",null,(0,l.mdx)("strong",{parentName:"p"},"Endpoint:")),(0,l.mdx)("p",null,(0,l.mdx)("inlineCode",{parentName:"p"},"POST <host>/rest/<store_code>/V1/carts/mine/estimate-shipping-methods")),(0,l.mdx)("p",null,(0,l.mdx)("strong",{parentName:"p"},"Headers:")),(0,l.mdx)("p",null,(0,l.mdx)("inlineCode",{parentName:"p"},"Content-Type: application/json")),(0,l.mdx)("p",null,(0,l.mdx)("inlineCode",{parentName:"p"},"Authorization: Bearer <customer token>")),(0,l.mdx)("p",null,(0,l.mdx)("strong",{parentName:"p"},"Payload:")),(0,l.mdx)("p",null,"The payload contains the shipping address."),(0,l.mdx)("details",null,(0,l.mdx)("summary",null,(0,l.mdx)("b",null,"Show code sample")),(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "address": {\n    "region": "New York",\n    "region_id": 43,\n    "region_code": "NY",\n    "country_id": "US",\n    "street": [\n      "123 Oak Ave"\n    ],\n    "postcode": "10577",\n    "city": "Purchase",\n    "firstname": "Jane",\n    "lastname": "Doe",\n    "customer_id": 4,\n    "email": "jdoe@example.com",\n    "telephone": "(512) 555-1111",\n    "same_as_billing": 1\n  }\n}\n'))),(0,l.mdx)("p",null,(0,l.mdx)("strong",{parentName:"p"},"Response:")),(0,l.mdx)("p",null,"Note that the cost for the ",(0,l.mdx)("inlineCode",{parentName:"p"},"flatrate")," shipping method is $15. The Sprite Yoga Companion Kit bundled product counts as one item. The Advanced Pilates & Yoga item does not have a shipping charge because the customer downloads this item."),(0,l.mdx)("details",null,(0,l.mdx)("summary",null,(0,l.mdx)("b",null,"Show code sample")),(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-json"},'[\n  {\n    "carrier_code": "flatrate",\n    "method_code": "flatrate",\n    "carrier_title": "Flat Rate",\n    "method_title": "Fixed",\n    "amount": 15,\n    "base_amount": 15,\n    "available": true,\n    "error_message": "",\n    "price_excl_tax": 15,\n    "price_incl_tax": 15\n  },\n  {\n    "carrier_code": "tablerate",\n    "method_code": "bestway",\n    "carrier_title": "Best Way",\n    "method_title": "Table Rate",\n    "amount": 5,\n    "base_amount": 5,\n    "available": true,\n    "error_message": "",\n    "price_excl_tax": 5,\n    "price_incl_tax": 5\n  }\n]\n'))),(0,l.mdx)("h3",{id:"set-shipping-and-billing-information"},"Set shipping and billing information"),(0,l.mdx)("p",null,"In this call, you specify the shipping and billing addresses, as well as the selected ",(0,l.mdx)("inlineCode",{parentName:"p"},"carrier_code")," and ",(0,l.mdx)("inlineCode",{parentName:"p"},"method_code"),". Since the Table Rate shipping method costs only $5, the customer selected this option."),(0,l.mdx)("p",null,"Commerce returnsa list of payment options and calculates the order totals."),(0,l.mdx)(d,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,l.mdx)("p",null,"Use the ",(0,l.mdx)("inlineCode",{parentName:"p"},"V1/guest-carts/<cartId>/shipping-information")," endpoint to set the billing and shipping information on behalf of a guest. Do not include an authorization token."),(0,l.mdx)("p",null,(0,l.mdx)("strong",{parentName:"p"},"Endpoint:")),(0,l.mdx)("p",null,(0,l.mdx)("inlineCode",{parentName:"p"},"POST <host>/rest/<store_code>/V1/carts/mine/shipping-information")),(0,l.mdx)("p",null,(0,l.mdx)("strong",{parentName:"p"},"Headers:")),(0,l.mdx)("p",null,(0,l.mdx)("inlineCode",{parentName:"p"},"Content-Type: application/json")),(0,l.mdx)("p",null,(0,l.mdx)("inlineCode",{parentName:"p"},"Authorization: Bearer <customer token>")),(0,l.mdx)("p",null,(0,l.mdx)("strong",{parentName:"p"},"Payload:")),(0,l.mdx)("details",null,(0,l.mdx)("summary",null,(0,l.mdx)("b",null,"Show code sample")),(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "addressInformation": {\n    "shipping_address": {\n      "region": "New York",\n      "region_id": 43,\n      "region_code": "NY",\n      "country_id": "US",\n      "street": [\n        "123 Oak Ave"\n      ],\n      "postcode": "10577",\n      "city": "Purchase",\n      "firstname": "Jane",\n      "lastname": "Doe",\n      "email": "jdoe@example.com",\n      "telephone": "512-555-1111"\n    },\n    "billing_address": {\n      "region": "New York",\n      "region_id": 43,\n      "region_code": "NY",\n      "country_id": "US",\n      "street": [\n        "123 Oak Ave"\n      ],\n      "postcode": "10577",\n      "city": "Purchase",\n      "firstname": "Jane",\n      "lastname": "Doe",\n      "email": "jdoe@example.com",\n      "telephone": "512-555-1111"\n    },\n    "shipping_carrier_code": "tablerate",\n    "shipping_method_code": "bestway"\n  }\n}\n'))),(0,l.mdx)("p",null,(0,l.mdx)("strong",{parentName:"p"},"Response:")),(0,l.mdx)("p",null,"The subtotal of the order is $160, and shipping charges are $5. The grand total is $165."),(0,l.mdx)("p",null,"The available payment methods are ",(0,l.mdx)("inlineCode",{parentName:"p"},"banktransfer")," and ",(0,l.mdx)("inlineCode",{parentName:"p"},"checkmo"),". The customer will specify a ",(0,l.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/payment-method"},"payment method")," in the next step."),(0,l.mdx)("details",null,(0,l.mdx)("summary",null,(0,l.mdx)("b",null,"Show code sample")),(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "payment_methods": [\n    {\n      "code": "cashondelivery",\n      "title": "Cash On Delivery"\n    },\n    {\n      "code": "banktransfer",\n      "title": "Bank Transfer Payment"\n    },\n    {\n      "code": "purchaseorder",\n      "title": "Purchase Order"\n    },\n    {\n      "code": "checkmo",\n      "title": "Check / Money order"\n    }\n  ],\n  "totals": {\n    "grand_total": 165,\n    "base_grand_total": 165,\n    "subtotal": 160,\n    "base_subtotal": 160,\n    "discount_amount": 0,\n    "base_discount_amount": 0,\n    "subtotal_with_discount": 160,\n    "base_subtotal_with_discount": 160,\n    "shipping_amount": 5,\n    "base_shipping_amount": 5,\n    "shipping_discount_amount": 0,\n    "base_shipping_discount_amount": 0,\n    "tax_amount": 0,\n    "base_tax_amount": 0,\n    "weee_tax_applied_amount": null,\n    "shipping_tax_amount": 0,\n    "base_shipping_tax_amount": 0,\n    "subtotal_incl_tax": 160,\n    "shipping_incl_tax": 5,\n    "base_shipping_incl_tax": 5,\n    "base_currency_code": "USD",\n    "quote_currency_code": "USD",\n    "items_qty": 4,\n    "items": [\n      {\n        "item_id": 6,\n        "price": 22,\n        "base_price": 22,\n        "qty": 1,\n        "row_total": 22,\n        "base_row_total": 22,\n        "row_total_with_discount": 0,\n        "tax_amount": 0,\n        "base_tax_amount": 0,\n        "tax_percent": 0,\n        "discount_amount": 0,\n        "base_discount_amount": 0,\n        "discount_percent": 0,\n        "price_incl_tax": 22,\n        "base_price_incl_tax": 22,\n        "row_total_incl_tax": 22,\n        "base_row_total_incl_tax": 22,\n        "options": "[]",\n        "weee_tax_applied_amount": null,\n        "weee_tax_applied": null,\n        "name": "Radiant Tee-M-Orange"\n      },\n      {\n        "item_id": 7,\n        "price": 18,\n        "base_price": 18,\n        "qty": 1,\n        "row_total": 18,\n        "base_row_total": 18,\n        "row_total_with_discount": 0,\n        "tax_amount": 0,\n        "base_tax_amount": 0,\n        "tax_percent": 0,\n        "discount_amount": 0,\n        "base_discount_amount": 0,\n        "discount_percent": 0,\n        "price_incl_tax": 18,\n        "base_price_incl_tax": 18,\n        "row_total_incl_tax": 18,\n        "base_row_total_incl_tax": 18,\n        "options": "[{\\"value\\":\\"Advanced Pilates & Yoga (Strength)\\",\\"label\\":\\"Downloads\\"}]",\n        "weee_tax_applied_amount": null,\n        "weee_tax_applied": null,\n        "name": "Advanced Pilates & Yoga (Strength)"\n      },\n      {\n        "item_id": 8,\n        "price": 68,\n        "base_price": 68,\n        "qty": 1,\n        "row_total": 68,\n        "base_row_total": 68,\n        "row_total_with_discount": 0,\n        "tax_amount": 0,\n        "base_tax_amount": 0,\n        "discount_amount": 0,\n        "base_discount_amount": 0,\n        "discount_percent": 0,\n        "price_incl_tax": 68,\n        "base_price_incl_tax": 68,\n        "row_total_incl_tax": 68,\n        "base_row_total_incl_tax": 68,\n        "options": "[{\\"value\\":\\"1 x Sprite Stasis Ball 65 cm <span class=\\\\\\"price\\\\\\">$27.00<\\\\/span>\\",\\"label\\":\\"Sprite Stasis Ball\\"},{\\"value\\":\\"1 x Sprite Foam Yoga Brick <span class=\\\\\\"price\\\\\\">$5.00<\\\\/span>\\",\\"label\\":\\"Sprite Foam Yoga Brick\\"},{\\"value\\":\\"1 x Sprite Yoga Strap 8 foot <span class=\\\\\\"price\\\\\\">$17.00<\\\\/span>\\",\\"label\\":\\"Sprite Yoga Strap\\"},{\\"value\\":\\"1 x Sprite Foam Roller <span class=\\\\\\"price\\\\\\">$19.00<\\\\/span>\\",\\"label\\":\\"Sprite Foam Roller\\"}]",\n        "weee_tax_applied_amount": null,\n        "weee_tax_applied": null,\n        "name": "Sprite Yoga Companion Kit"\n      },\n      {\n        "item_id": 13,\n        "price": 52,\n        "base_price": 52,\n        "qty": 1,\n        "row_total": 52,\n        "base_row_total": 52,\n        "row_total_with_discount": 0,\n        "tax_amount": 0,\n        "base_tax_amount": 0,\n        "tax_percent": 0,\n        "discount_amount": 0,\n        "base_discount_amount": 0,\n        "discount_percent": 0,\n        "price_incl_tax": 52,\n        "base_price_incl_tax": 52,\n        "row_total_incl_tax": 52,\n        "base_row_total_incl_tax": 52,\n        "options": "[{\\"value\\":\\"Gray\\",\\"label\\":\\"Color\\"},{\\"value\\":\\"S\\",\\"label\\":\\"Size\\"}]",\n        "weee_tax_applied_amount": null,\n        "weee_tax_applied": null,\n        "name": "Chaz Kangeroo Hoodie"\n      }\n    ],\n    "total_segments": [\n      {\n        "code": "subtotal",\n        "title": "Subtotal",\n        "value": 160\n      },\n      {\n        "code": "shipping",\n        "title": "Shipping & Handling (Best Way - Table Rate)",\n        "value": 5\n      },\n      {\n        "code": "tax",\n        "title": "Tax",\n        "value": 0,\n        "extension_attributes": {\n          "tax_grandtotal_details": []\n        }\n      },\n      {\n        "code": "grand_total",\n        "title": "Grand Total",\n        "value": 165,\n        "area": "footer"\n      }\n    ]\n  }\n}\n'))),(0,l.mdx)(d,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,l.mdx)("p",null,"If you tried this call on your own, and the value of the ",(0,l.mdx)("inlineCode",{parentName:"p"},"shipping_amount")," parameter is ",(0,l.mdx)("inlineCode",{parentName:"p"},"0"),', then you did not deactivate the "Spend $50 or more - shipping is free!" cart price rule. See ',(0,l.mdx)("a",{parentName:"p",href:"/commerce-webapi/rest/tutorials/orders/order-config-store#deactivate-a-cart-price-rule"},"Deactivate a cart price rule")," for details."),(0,l.mdx)("h3",{id:"verify-this-step"},"Verify this step"),(0,l.mdx)("p",null,(0,l.mdx)("a",{parentName:"p",href:"https://glossary.magento.com/sign-in-sign-out"},"Sign in")," as the customer and go to the checkout page."),(0,l.mdx)("p",null,"The payment method is Bank Transfer, the billing and shipping addresses are displayed, and the shipping charges have been calculated."))}_.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-rest-tutorials-orders-order-prepare-checkout-md-ebad2fd82ebf43fcdad3.js.map