"use strict";(self.webpackChunkcommerce_webapi=self.webpackChunkcommerce_webapi||[]).push([[3389],{80666:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return l},default:function(){return c}});var a,r=n(87462),o=n(63366),i=(n(15007),n(64983)),d=n(91515),m=["components"],l={},p=(a="InlineAlert",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.mdx)("div",e)}),s={_frontmatter:l},u=d.Z;function c(e){var t=e.components,n=(0,o.Z)(e,m);return(0,i.mdx)(u,(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"construct-a-request"},"Construct a request"),(0,i.mdx)("p",null,"To configure a web API, developers define some of the elements of each API call in the ",(0,i.mdx)("inlineCode",{parentName:"p"},"<module root dir>/vendor/<vendor-name>/<module-name>/etc/webapi.xml")," file, where ",(0,i.mdx)("inlineCode",{parentName:"p"},"<vendor-name>")," is your vendor name (for example, ",(0,i.mdx)("inlineCode",{parentName:"p"},"sample"),") and ",(0,i.mdx)("inlineCode",{parentName:"p"},"<module-name>")," is your module name (which exactly matches its definition in ",(0,i.mdx)("inlineCode",{parentName:"p"},"composer.json"),"). For example, the web API for the Customer service is defined in the ",(0,i.mdx)("inlineCode",{parentName:"p"},"<root>/vendor/sample/module-customer/etc/webapi.xml")," configuration file. Service data interfaces and builders define the required and optional parameters and the return values for the API calls."),(0,i.mdx)("h2",{id:"overview"},"Overview"),(0,i.mdx)("p",null,"The following table and the sections that follow the table describe web API call elements:"),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Element"),(0,i.mdx)("th",{parentName:"tr",align:null},"Specifies"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("a",{parentName:"td",href:"#http-verb"},"HTTP verb")),(0,i.mdx)("td",{parentName:"tr",align:null},"The action to perform against the endpoint.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("a",{parentName:"td",href:"#endpoint"},"Endpoint")),(0,i.mdx)("td",{parentName:"tr",align:null},"A combination of the ",(0,i.mdx)("em",{parentName:"td"},"server")," that fulfills a request, the web service, and the ",(0,i.mdx)("em",{parentName:"td"},"resource")," against which the request is being made.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("a",{parentName:"td",href:"#http-headers"},"HTTP headers")),(0,i.mdx)("td",{parentName:"tr",align:null},"The authentication token, the call request and response formats, and other information.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("a",{parentName:"td",href:"#call-payload"},"Call payload")),(0,i.mdx)("td",{parentName:"tr",align:null},"A set of input parameters and attributes that you supply with the request. API operations have both ",(0,i.mdx)("strong",{parentName:"td"},"required")," and ",(0,i.mdx)("strong",{parentName:"td"},"optional")," inputs. You specify input parameters in the URI and input attributes in a request body. You can specify a JSON- or XML-formatted request body.")))),(0,i.mdx)("h3",{id:"http-verb"},"HTTP verb"),(0,i.mdx)("p",null,"Specify one of these HTTP verbs in the request:"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"GET"),". Requests transfer of a current representation of the target resource. If you omit the verb, ",(0,i.mdx)("inlineCode",{parentName:"li"},"GET")," is the default."),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"PUT"),". Requests that the state of the target resource be created or replaced with the state defined by the representation enclosed in the request message payload."),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"POST"),". Requests that the origin server accept the representation enclosed in the request as data to be processed by the target resource."),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"DELETE"),". Requests that the origin server delete the target resource.")),(0,i.mdx)("h3",{id:"endpoint"},"Endpoint"),(0,i.mdx)("p",null,"An endpoint is a combination of the ",(0,i.mdx)("em",{parentName:"p"},"server")," that fulfills a request, the web service, the store code, the resource against which the request is being made, and any template parameters."),(0,i.mdx)("p",null,"For example, in the ",(0,i.mdx)("inlineCode",{parentName:"p"},"https://example.com/rest/default/V1/customerGroups/:id")," endpoint, the server is ",(0,i.mdx)("inlineCode",{parentName:"p"},"example.com"),", the web service is ",(0,i.mdx)("inlineCode",{parentName:"p"},"rest"),", the resource is ",(0,i.mdx)("inlineCode",{parentName:"p"},"/V1/customerGroups"),", and the template parameter is ",(0,i.mdx)("inlineCode",{parentName:"p"},"id"),"."),(0,i.mdx)("p",null,"A store code can have one of the following values."),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"The store's assigned store code."),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"default"),". This is the default value when no store code is provided."),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"all"),". This value only applies to endpoints defined in the CMS and Product modules. If this value is specified, the API call affects all of the merchant's stores.")),(0,i.mdx)("h3",{id:"http-headers"},"HTTP headers"),(0,i.mdx)(p,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,i.mdx)("p",null,"To specify an HTTP header in a cURL command, use the ",(0,i.mdx)("inlineCode",{parentName:"p"},"-H")," option."),(0,i.mdx)("p",null,"Specify one or more of the following HTTP headers in your web API calls:"),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"HTTP header"),(0,i.mdx)("th",{parentName:"tr",align:null},"Description"),(0,i.mdx)("th",{parentName:"tr",align:null},"Syntax"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Authorization")),(0,i.mdx)("td",{parentName:"tr",align:null},"Required, except for calls made on behalf of a guest. Specifies the authentication token that proves you as the owner of a customer, admin, or integration account. You specify the token in the ",(0,i.mdx)("inlineCode",{parentName:"td"},"Authorization")," request header with the ",(0,i.mdx)("inlineCode",{parentName:"td"},"Bearer")," HTTP authorization scheme."),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Authorization: Bearer <TOKEN>")," ",(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("inlineCode",{parentName:"td"},"<TOKEN>")," is the authentication token returned by the token service. See ",(0,i.mdx)("a",{parentName:"td",href:"./authentication/"},"Authentication"),".")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Accept")),(0,i.mdx)("td",{parentName:"tr",align:null},"Optional. Specifies the format of the response body. Default is ",(0,i.mdx)("inlineCode",{parentName:"td"},"JSON"),"."),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Accept: application/<FORMAT>")," ",(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("inlineCode",{parentName:"td"},"<FORMAT>")," is either ",(0,i.mdx)("inlineCode",{parentName:"td"},"JSON")," or ",(0,i.mdx)("inlineCode",{parentName:"td"},"XML"),".")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Content-Type")),(0,i.mdx)("td",{parentName:"tr",align:null},"Required for operations with a request body. Specifies the format of the request body."),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Content-Type:application/<FORMAT>")," ",(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("inlineCode",{parentName:"td"},"<FORMAT>")," is either ",(0,i.mdx)("inlineCode",{parentName:"td"},"JSON")," or ",(0,i.mdx)("inlineCode",{parentName:"td"},"XML"),".")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"X-Captcha")),(0,i.mdx)("td",{parentName:"tr",align:null},"A shopper-entered CAPTCHA value. It is required when a shopper enters a CAPTCHA value on the frontend, unless an integration token is provided. Forms requiring CAPTCHA values are configured at ",(0,i.mdx)("strong",{parentName:"td"},"Stores")," > ",(0,i.mdx)("strong",{parentName:"td"},"Configuration")," > ",(0,i.mdx)("strong",{parentName:"td"},"Customers")," > ",(0,i.mdx)("strong",{parentName:"td"},"Customer Configuration")," > ",(0,i.mdx)("strong",{parentName:"td"},"CAPTCHA")," > ",(0,i.mdx)("strong",{parentName:"td"},"Forms"),"."),(0,i.mdx)("td",{parentName:"tr",align:null},"String")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"X-ReCaptcha")),(0,i.mdx)("td",{parentName:"tr",align:null},"A value generated by the Google reCAPTCHA API. It is required when reCAPTCHA is enabled for certain forms, unless an integration token is provided. Forms requiring reCAPTCHA values are configured at ",(0,i.mdx)("strong",{parentName:"td"},"Stores")," > ",(0,i.mdx)("strong",{parentName:"td"},"Security")," > ",(0,i.mdx)("strong",{parentName:"td"},"Google reCAPTCHA Storefront")," > ",(0,i.mdx)("strong",{parentName:"td"},"Storefront"),"."),(0,i.mdx)("td",{parentName:"tr",align:null},"String")))),(0,i.mdx)("h3",{id:"call-payload"},"Call payload"),(0,i.mdx)("p",null,"The call payload is a set of input ",(0,i.mdx)("i",null,"parameters")," and ",(0,i.mdx)("i",null,"attributes")," that you supply with the request. API operations have both ",(0,i.mdx)("em",{parentName:"p"},"required")," and ",(0,i.mdx)("em",{parentName:"p"},"optional")," inputs."),(0,i.mdx)("p",null,"You specify input parameters in the URI. For example, in the ",(0,i.mdx)("inlineCode",{parentName:"p"},"GET /V1/customers/:customerId")," URI, you must specify the ",(0,i.mdx)("inlineCode",{parentName:"p"},"customerId")," template parameter. This parameter filters the response by the specified customer ID."),(0,i.mdx)("p",null,"You specify input attributes in a JSON- or XML-formatted request body. For example, in the ",(0,i.mdx)("inlineCode",{parentName:"p"},"POST /V1/customers")," call, you must specify a request body like this:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "customer": {\n        "email": "user@example.com",\n        "firstname": "John",\n        "lastname": "Doe"\n    },\n    "addresses": [\n        {\n            "defaultShipping": true,\n            "defaultBilling": true,\n            "firstname": "John",\n            "lastname": "Doe",\n            "region": {\n                "regionCode": "CA",\n                "region": "California",\n                "regionId": 12\n            },\n            "postcode": "90001",\n            "street": ["Zoe Ave"],\n            "city": "Los Angeles",\n            "telephone": "555-000-00-00",\n            "countryId": "US"\n        }\n    ]\n}\n')),(0,i.mdx)("p",null,"This JSON-formatted request body includes a ",(0,i.mdx)("inlineCode",{parentName:"p"},"customer")," object with the customer email, first name, and last name, and customer address information. The information in this request body is used to populate the new customer account."),(0,i.mdx)("h2",{id:"construct-a-request-1"},"Construct a request"),(0,i.mdx)("p",null,"This example shows you how to construct a REST web API call to create an account."),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Open the ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/magento/magento2/tree/2.4/app/code/Magento/Customer/etc/webapi.xml"},"Magento/Customer/etc/webapi.xml"))),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Find the route element that defines the ",(0,i.mdx)("inlineCode",{parentName:"p"},"createAccount")," call:"),(0,i.mdx)("pre",{parentName:"li"},(0,i.mdx)("code",{parentName:"pre",className:"language-xml"},'<route url="/V1/customers" method="POST">\n   <service class="Magento\\Customer\\Api\\AccountManagementInterface" method="createAccount"/>\n   <resources>\n      <resource ref="anonymous"/>\n   </resources>\n</route>\n'))),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Use the ",(0,i.mdx)("inlineCode",{parentName:"p"},"method")," and ",(0,i.mdx)("inlineCode",{parentName:"p"},"url")," values on the ",(0,i.mdx)("inlineCode",{parentName:"p"},"route")," element to construct the URI. In this example, the URI is POST ",(0,i.mdx)("inlineCode",{parentName:"p"},"/V1/customers"),".")),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Use the ",(0,i.mdx)("inlineCode",{parentName:"p"},"class")," attribute on the ",(0,i.mdx)("inlineCode",{parentName:"p"},"service")," element to identify the service interface. In this example, the service interface is the ",(0,i.mdx)("inlineCode",{parentName:"p"},"AccountManagementInterface")," PHP file."),(0,i.mdx)("p",{parentName:"li"},"Open the ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/magento/magento2/tree/2.4/app/code/Magento/Customer/Api/AccountManagementInterface.php"},"AccountManagementInterface.php")," file and find the ",(0,i.mdx)("inlineCode",{parentName:"p"},"createAccount")," method, as follows:"),(0,i.mdx)("pre",{parentName:"li"},(0,i.mdx)("code",{parentName:"pre",className:"language-php?start_inline=1"},"public function createAccount(\n     \\Magento\\Customer\\Api\\Data\\CustomerInterface $customer,\n     $password = null,\n     $redirectUrl = ''\n )\n")),(0,i.mdx)("p",{parentName:"li"}," The ",(0,i.mdx)("inlineCode",{parentName:"p"},"createAccount")," call requires a ",(0,i.mdx)("inlineCode",{parentName:"p"},"customer")," data object. The ",(0,i.mdx)("inlineCode",{parentName:"p"},"password")," and ",(0,i.mdx)("inlineCode",{parentName:"p"},"redirectUrl")," values are optional. The default ",(0,i.mdx)("inlineCode",{parentName:"p"},"password")," value is ",(0,i.mdx)("inlineCode",{parentName:"p"},"null")," and the default ",(0,i.mdx)("inlineCode",{parentName:"p"},"redirectUrl")," value is blank.")),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"To pass the ",(0,i.mdx)("inlineCode",{parentName:"p"},"customer")," data object in the POST call payload, specify ",(0,i.mdx)("a",{parentName:"p",href:"http://www.json.com/"},"JSON")," or XML request body on the call."))),(0,i.mdx)("h3",{id:"customers-search-api-request-example"},"Customers Search API request example"),(0,i.mdx)("p",null,"The following example builds a Customers Search request based on search criteria. It returns a list of customers that match given search criteria."),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Prepare ",(0,i.mdx)("inlineCode",{parentName:"p"},"Authorization"),", ",(0,i.mdx)("inlineCode",{parentName:"p"},"Accept")," and ",(0,i.mdx)("inlineCode",{parentName:"p"},"Content-Type")," headers to be passed to a request object. Use the Authorization token returned by the token service."),(0,i.mdx)("pre",{parentName:"li"},(0,i.mdx)("code",{parentName:"pre",className:"language-php?start_inline=1"},"$token = 'token';\n$httpHeaders = new \\Zend\\Http\\Headers();\n$httpHeaders->addHeaders([\n   'Authorization' => 'Bearer ' . $token,\n   'Accept' => 'application/json',\n   'Content-Type' => 'application/json'\n]);\n"))),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Open the ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/magento/magento2/tree/2.4/app/code/Magento/Customer/etc/webapi.xml"},"Magento/Customer/etc/webapi.xml"),"  configuration file and find the ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/magento/magento2/tree/2.4/app/code/Magento/Customer/Api/CustomerRepositoryInterface.php"},"CustomerRepositoryInterface")," interface with the ",(0,i.mdx)("inlineCode",{parentName:"p"},"getList")," method.")),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Set the headers, URI and method to a request object. Use URI ",(0,i.mdx)("inlineCode",{parentName:"p"},"/V1/customers/search")," and method ",(0,i.mdx)("inlineCode",{parentName:"p"},"GET")," values. Use the ",(0,i.mdx)("inlineCode",{parentName:"p"},"searchCriteria")," parameter to complete the Customer Search query. See ",(0,i.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/commerce/webapi/rest/use-rest/performing-searches/"},"searchCriteria usage"),"."),(0,i.mdx)("p",{parentName:"li"},'The following example finds customers whose first name contains "ver" or whose last name contains "Costello".'),(0,i.mdx)("pre",{parentName:"li"},(0,i.mdx)("code",{parentName:"pre",className:"language-php?start_inline=1"},"$request = new \\Zend\\Http\\Request();\n$request->setHeaders($httpHeaders);\n$request->setUri('http://magento.ll/rest/V1/customers/search');\n$request->setMethod(\\Zend\\Http\\Request::METHOD_GET);\n\n$params = new \\Zend\\Stdlib\\Parameters([\n    'searchCriteria' => [\n        'filterGroups' => [\n            0 => [\n                'filters' => [\n                    0 => [\n                        'field' => 'firstname',\n                        'value' => '%ver%',\n                        'condition_type' => 'like'\n                    ],\n                    1 => [\n                        'field' => 'lastname',\n                        'value' => '%Costello%',\n                        'condition_type' => 'like'\n                    ]\n                ]\n            ]\n        ],\n        'current_page' => 1,\n        'page_size' => 10\n    ],\n]);\n\n$request->setQuery($params);\n"))),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Prepare a HTTP Curl client object and pass the request object to ",(0,i.mdx)("inlineCode",{parentName:"p"},"Client::send()")," method."),(0,i.mdx)("pre",{parentName:"li"},(0,i.mdx)("code",{parentName:"pre",className:"language-php?start_inline=1"},"$client = new \\Zend\\Http\\Client();\n$options = [\n   'adapter'   => 'Zend\\Http\\Client\\Adapter\\Curl',\n   'curloptions' => [CURLOPT_FOLLOWLOCATION => true],\n   'maxredirects' => 0,\n   'timeout' => 30\n ];\n $client->setOptions($options);\n\n $response = $client->send($request);\n")))),(0,i.mdx)("p",null,"This request returns a list of all customers in JSON format, as shown below. You can also specify XML format by changing ",(0,i.mdx)("inlineCode",{parentName:"p"},"Accept")," header of the request."),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "items": [\n        {\n            "id": 1,\n            "group_id": 1,\n            "default_billing": "1",\n            "default_shipping": "1",\n            "created_at": "2017-12-05 09:50:11",\n            "updated_at": "2018-09-22 06:32:50",\n            "created_in": "Default Store View",\n            "dob": "1973-12-15",\n            "email": "roni_cost@example.com",\n            "firstname": "Veronica",\n            "lastname": "Costello",\n            "gender": 2,\n            "store_id": 1,\n            "website_id": 1,\n            "addresses": [\n                {\n                    "id": 1,\n                    "customer_id": 1,\n                    "region": {\n                        "region_code": "MI",\n                        "region": "Michigan",\n                        "region_id": 33\n                    },\n                    "region_id": 33,\n                    "country_id": "US",\n                    "street": [\n                        "6146 Honey Bluff Parkway"\n                    ],\n                    "telephone": "(555) 229-3326",\n                    "postcode": "49628-7978",\n                    "city": "Calder",\n                    "firstname": "Veronica",\n                    "lastname": "Costello",\n                    "default_shipping": true,\n                    "default_billing": true\n                },\n                {\n                    "id": 19,\n                    "customer_id": 1,\n                    "region": {\n                        "region_code": "London ",\n                        "region": "London ",\n                        "region_id": 0\n                    },\n                    "region_id": 0,\n                    "country_id": "GB",\n                    "street": [\n                        "1 Studio 103 The Business Centre 61"\n                    ],\n                    "telephone": "1234567890",\n                    "postcode": "CF24 3DG",\n                    "city": "Tottenham ",\n                    "firstname": "Veronica",\n                    "lastname": "Costello"\n                }\n            ],\n            "disable_auto_group_change": 0\n        }\n    ],\n    "search_criteria": {\n        "filter_groups": [\n            {\n                "filters": [\n                    {\n                        "field": "firstname",\n                        "value": "%ver%",\n                        "condition_type": "like"\n                    }\n                ]\n            }\n        ]\n    },\n    "total_count": 1\n}\n')),(0,i.mdx)("h4",{id:"related-topics"},"Related topics"),(0,i.mdx)("p",null,"Run the web API call through a ",(0,i.mdx)("a",{parentName:"p",href:"./gs-curl.md"},"cURL command")," or a REST client."))}c.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-get-started-gs-web-api-request-md-6a9e287a331f42ea772a.js.map