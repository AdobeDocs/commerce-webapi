"use strict";(self.webpackChunkcommerce_webapi=self.webpackChunkcommerce_webapi||[]).push([[6282],{58116:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return o},default:function(){return s}});var n=a(87462),r=a(63366),m=(a(15007),a(64983)),i=a(91515),d=["components"],o={},p={_frontmatter:o},l=i.Z;function s(e){var t=e.components,a=(0,r.Z)(e,d);return(0,m.mdx)(l,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,m.mdx)("h1",{id:"braintree-payment-method"},"Braintree payment method"),(0,m.mdx)("p",null,"Braintree is a payment gateway that processes debit and credit card payments."),(0,m.mdx)("h2",{id:"braintree-workflow"},"Braintree workflow"),(0,m.mdx)("p",null,"The following diagram shows the workflow for placing an order when Braintree is the selected payment method."),(0,m.mdx)("p",null,(0,m.mdx)("img",{parentName:"p",src:"/commerce-webapi/assets/b05a179bfff78ad0c857d672dfe7e518/braintree.svg",alt:"Braintree sequence diagram"})),(0,m.mdx)("ol",null,(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The PWA client calls the ",(0,m.mdx)("a",{parentName:"p",href:"../schema/checkout/mutations/create-braintree-client-token.md"},(0,m.mdx)("inlineCode",{parentName:"a"},"createBraintreeClientToken"))," mutation to generate the client token.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The application forwards the request to Braintree.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"Braintree returns the token to Magento.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The application forwards the token to the client.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The PWA client uses the token to initialize the ",(0,m.mdx)("a",{parentName:"p",href:"https://developers.braintreepayments.com/guides/hosted-fields/overview/javascript/v3"},"Braintree hosted fields"),". These fields collect and tokenize payment information via a secure iframe. This process occurs over several steps."),(0,m.mdx)("ul",{parentName:"li"},(0,m.mdx)("li",{parentName:"ul"},(0,m.mdx)("p",{parentName:"li"},"On the checkout page, the customer selects ",(0,m.mdx)("strong",{parentName:"p"},"Credit Card")," as the payment method and enters payment information using the Braintree hosted fields. Then the customer clicks ",(0,m.mdx)("strong",{parentName:"p"},"Place Order"),".")),(0,m.mdx)("li",{parentName:"ul"},(0,m.mdx)("p",{parentName:"li"},"The client requests the Braintree SDK tokenize the user-input payment information.")))),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The Braintree SDK submits the payment information to Braintree client-side and returns a ",(0,m.mdx)("a",{parentName:"p",href:"https://braintree.github.io/braintree-web/3.46.0/HostedFields.html#tokenize"},"payment token")," (nonce) to the client.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The client extracts the payment nonce from the ",(0,m.mdx)("a",{parentName:"p",href:"https://braintree.github.io/braintree-web/3.46.0/HostedFields.html#~tokenizePayload"},"Tokenized Payload"),"."),(0,m.mdx)("p",{parentName:"li"},"The client uses the ",(0,m.mdx)("a",{parentName:"p",href:"../schema/cart/mutations/set-payment-method.md"},(0,m.mdx)("inlineCode",{parentName:"a"},"setPaymentMethodOnCart"))," mutation to set the payment method to ",(0,m.mdx)("inlineCode",{parentName:"p"},"braintree"),". The payment method nonce is passed with other required and optional properties in the ",(0,m.mdx)("a",{parentName:"p",href:"#braintree-object"},(0,m.mdx)("inlineCode",{parentName:"a"},"braintree"))," object.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The application returns a ",(0,m.mdx)("inlineCode",{parentName:"p"},"Cart")," object.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The client uses the ",(0,m.mdx)("a",{parentName:"p",href:"../schema/cart/mutations/place-order.md"},(0,m.mdx)("inlineCode",{parentName:"a"},"placeOrder"))," mutation.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The application sends an authorization request to Braintree.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"Braintree sends the response to Magento.")),(0,m.mdx)("li",{parentName:"ol"},(0,m.mdx)("p",{parentName:"li"},"The application creates an order and sends an order ID in response to the ",(0,m.mdx)("inlineCode",{parentName:"p"},"placeOrder")," mutation."))),(0,m.mdx)("h2",{id:"setpaymentmethodoncart-mutation"},(0,m.mdx)("inlineCode",{parentName:"h2"},"setPaymentMethodOnCart")," mutation"),(0,m.mdx)("p",null,"When you set the payment method to Braintree in the ",(0,m.mdx)("a",{parentName:"p",href:"../schema/cart/mutations/set-payment-method.md"},(0,m.mdx)("inlineCode",{parentName:"a"},"setPaymentMethodOnCart"))," mutation, the ",(0,m.mdx)("inlineCode",{parentName:"p"},"payment_method")," object must contain a ",(0,m.mdx)("inlineCode",{parentName:"p"},"braintree")," object."),(0,m.mdx)("h3",{id:"braintree-object"},"braintree object"),(0,m.mdx)("p",null,"The ",(0,m.mdx)("inlineCode",{parentName:"p"},"braintree")," object must contain the following attributes:"),(0,m.mdx)("table",null,(0,m.mdx)("thead",{parentName:"table"},(0,m.mdx)("tr",{parentName:"thead"},(0,m.mdx)("th",{parentName:"tr",align:null},"Attribute"),(0,m.mdx)("th",{parentName:"tr",align:null},"Data Type"),(0,m.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,m.mdx)("tbody",{parentName:"table"},(0,m.mdx)("tr",{parentName:"tbody"},(0,m.mdx)("td",{parentName:"tr",align:null},(0,m.mdx)("inlineCode",{parentName:"td"},"payment_method_nonce")),(0,m.mdx)("td",{parentName:"tr",align:null},"String!"),(0,m.mdx)("td",{parentName:"tr",align:null},"The one-time payment token generated by Braintree payment gateway based on card details. Required field for sale transactions")),(0,m.mdx)("tr",{parentName:"tbody"},(0,m.mdx)("td",{parentName:"tr",align:null},(0,m.mdx)("inlineCode",{parentName:"td"},"is_active_payment_token_enabler")),(0,m.mdx)("td",{parentName:"tr",align:null},"Boolean!"),(0,m.mdx)("td",{parentName:"tr",align:null},"States whether a customer-entered credit/debit card should be tokenized for later usage. Required only if Vault is enabled for Braintree payment integration")),(0,m.mdx)("tr",{parentName:"tbody"},(0,m.mdx)("td",{parentName:"tr",align:null},(0,m.mdx)("inlineCode",{parentName:"td"},"device_data")),(0,m.mdx)("td",{parentName:"tr",align:null},"String"),(0,m.mdx)("td",{parentName:"tr",align:null},"Optional. Contains a fingerprint provided by the Braintree JS SDK. It should be sent with sale transaction details to the Braintree payment gateway. Specify a value only if Kount (advanced fraud protection) is enabled for Braintree payment integration")))),(0,m.mdx)("h2",{id:"example-usage"},"Example Usage"),(0,m.mdx)("p",null,"The following example shows the ",(0,m.mdx)("inlineCode",{parentName:"p"},"setPaymentMethodOnCart")," mutation constructed for the Braintree payment method."),(0,m.mdx)("p",null,(0,m.mdx)("strong",{parentName:"p"},"Request:")),(0,m.mdx)("pre",null,(0,m.mdx)("code",{parentName:"pre",className:"language-text"},'mutation {\n  setPaymentMethodOnCart(input: {\n    cart_id: "IeTUiU0oCXjm0uRqGCOuhQ2AuQatogjG"\n    payment_method: {\n      code: "braintree"\n      braintree: {\n        payment_method_nonce: "fake-nonce"\n        is_active_payment_token_enabler: false\n      }\n    }\n  }) {\n  cart {\n    selected_payment_method {\n      code\n    }\n  }\n}\n')),(0,m.mdx)("p",null,(0,m.mdx)("strong",{parentName:"p"},"Response:")),(0,m.mdx)("pre",null,(0,m.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "setPaymentMethodOnCart": {\n      "cart": {\n        "selected_payment_method": {\n          "code": "braintree"\n        }\n      }\n    }\n  }\n}\n')))}s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-graphql-payment-methods-braintree-md-70af061dcc6d9c7bf13e.js.map